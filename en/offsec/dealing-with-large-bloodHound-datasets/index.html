<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Dealing with large BloodHound datasets" /><meta name="author" content="Helvio Junior (m4v3r1ck)" /><meta property="og:locale" content="en_US" /><meta name="description" content="Aprenda como resolver o problema de lentidão na importação de grandes arquivos JSON do BloodHound." /><meta property="og:description" content="Aprenda como resolver o problema de lentidão na importação de grandes arquivos JSON do BloodHound." /><link rel="canonical" href="https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" /><meta property="og:url" content="https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" /><meta property="og:site_name" content="Helvio Junior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-21T23:30:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dealing with large BloodHound datasets" /><meta name="twitter:site" content="@helvioju" /><meta name="twitter:creator" content="@Helvio Junior (m4v3r1ck)" /><meta name="google-site-verification" content="JR4IIP9jfvOwxn2ybV_Qn0SrtDPlTrKomdPWgBuP55k"" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Helvio Junior (m4v3r1ck)"},"dateModified":"2023-10-06T11:59:04-03:00","datePublished":"2023-08-21T23:30:00-03:00","description":"Aprenda como resolver o problema de lentidão na importação de grandes arquivos JSON do BloodHound.","headline":"Dealing with large BloodHound datasets","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/"},"url":"https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/"}</script><title>Dealing with large BloodHound datasets | Helvio Junior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Helvio Junior"><meta name="application-name" content="Helvio Junior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/m4v3r1ck.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Helvio Junior</a></div><div class="site-subtitle font-italic">Cyber security researcher, speaker, low level and binary exploitation entusiast. <br /><br />"I’m just a child who has never grown up. I still keep asking these 'how' & 'why' questions. Occasionally, I find an answer. Stephen Hawking"</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://www.linkedin.com/in/helviojunior" aria-label="linkedin" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/@Sec4US" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/helviojunior" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['helvio.junior','sec4us.com.br'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/en"> En </a> </span> <span> <a href="/offsec"> Offsec </a> </span> <span>Dealing with large BloodHound datasets</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Dealing with large BloodHound datasets</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Helvio Junior (m4v3r1ck) </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Aug 21, 2023, 11:30 PM -0300" prep="on" > Aug 21, 2023 <i class="unloaded">2023-08-21T23:30:00-03:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 6, 2023, 11:59 AM -0300" prefix="Updated " > Oct 6, 2023 <i class="unloaded">2023-10-06T11:59:04-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2687 words">14 min</span></div></div><div class="post-content"> <a href="/assets/2023/08/bloodhound.png" class="popup img-link preview-img"><img data-src="/assets/2023/08/bloodhound.png" alt="BloodHound" class="lazyload" data-proofer-ignore></a><h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>During a penetration test (Pentest) that involves the Microsoft Active Directory environment (aka AD), various tools are often used to automate and transform data into actionable insights. One such tool is <a href="https://github.com/BloodHoundAD/BloodHound">BloodHound</a>. The unique feature of BloodHound is its ability to gather a plethora of information from an Active Directory environment and present it in a manner that isn’t just a collection of isolated data points. Instead, it relates them in ways that provide value, creating hypotheses for potential paths to be explored.</p><p>BloodHound represents various AD objects as nodes, for example, <code class="language-plaintext highlighter-rouge">Users</code>, <code class="language-plaintext highlighter-rouge">Computers</code>, <code class="language-plaintext highlighter-rouge">GPOs</code>, <code class="language-plaintext highlighter-rouge">ACLs</code>, <code class="language-plaintext highlighter-rouge">ACEs</code>, and more. Their respective relationships are represented as edges, for instance, <code class="language-plaintext highlighter-rouge">MemberOf</code>, <code class="language-plaintext highlighter-rouge">Owns</code>, <code class="language-plaintext highlighter-rouge">CanRDP</code>, <code class="language-plaintext highlighter-rouge">GenericWrite</code>, etc. This makes it possible to identify potential paths for an exploitation chain.</p><p>In this post, I will share my experience using BloodHound, including the primary challenge I encountered when handling/importing large datasets. Additionally, I will demonstrate how I tackled the main issue of “slow data import in BloodHound” by creating a tool to manipulate, process, and import BloodHound data.</p><p>BloodHound’s <a href="https://github.com/BloodHoundAD/BloodHound">GitHub</a> describes it as:</p><blockquote class="prompt-tip"><p>BloodHound uses graph theory to reveal hidden and often unintended relationships in an Active Directory or Azure environment. Attackers can use BloodHound to easily identify complex attack paths that would otherwise be impossible to quickly discern. Both Red Team (attack) and Blue Team (defense) can use it to identify and eliminate those same attack paths. Teams can use BloodHound to gain a deeper understanding of privilege relationships in an Active Directory or Azure environment.</p></blockquote><p>Currently, BloodHound supports data extraction and processing from Microsoft Active Directory On-Premises and Azure AD. However, this post focuses on the process for AD On-Premises.</p><p>The first phase of using BloodHound is to collect data from Active Directory servers via the LDAP protocol using one of the available collectors, like SharpHound (or AzureHound’s APIs for Azure). These data are then stored in compressed JSON files to reduce file size. Next, these files can be moved to the system where analysis will be performed and imported into a Neo4j database. Finally, queries can be conducted, either using the BloodHound tool, other third-party tools, or directly using Neo4j’s Cypher language. This article will walk through these three stages.</p><p><a href="/assets/2023/08/ad_001.jpg" class="img-link shimmer" ><img data-src="/assets/2023/08/ad_001.jpg" alt="AD Image" class="lazyload" data-proofer-ignore></a></p><h2 id="collectors"><span class="me-2">Collectors</span><a href="#collectors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The primary tool provided with BloodHound to gather Active Directory information is SharpHound. SharpHound is a .NET 4 executable with various parameters to specify what data needs to be collected. These parameters influence the amount of data gathered and how stealthily the tool operates. SharpHound collects information from an <code class="language-plaintext highlighter-rouge">LDAP/LDAPS</code> domain controller. Depending on the specified collection/enumeration parameters, it might also connect to individual hosts via the RPC protocol using a <code class="language-plaintext highlighter-rouge">named pipe</code> (ncacn_np) on the <code class="language-plaintext highlighter-rouge">Microsoft-DS</code> port (<code class="language-plaintext highlighter-rouge">445/TCP</code>) to fetch details about local group members and logged-in users.</p><p>Apart from SharpHound, there are several other options for data collection, as listed in the table below:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Tool<th style="text-align: center">Language<th style="text-align: left">URL<th style="text-align: left">Notes<tbody><tr><td style="text-align: left">SharpHound<td style="text-align: center">.NET<td style="text-align: left"><a href="https://github.com/BloodHoundAD/SharpHound/">SharpHound GitHub</a><td style="text-align: left">Can also be reflected/run in memory<tr><td style="text-align: left">AzureHound<td style="text-align: center">PowerShell<td style="text-align: left"><a href="https://github.com/BloodHoundAD/AzureHound/">AzureHound GitHub</a><td style="text-align: left">Specifically for Azure environments<tr><td style="text-align: left">SharpHound.ps1<td style="text-align: center">PowerShell<td style="text-align: left"><a href="https://github.com/BloodHoundAD/BloodHound/">BloodHound GitHub</a><td style="text-align: left">Reflectively runs SharpHound.exe in memory<tr><td style="text-align: left">BloodHound.py<td style="text-align: center">Python<td style="text-align: left"><a href="https://github.com/fox-it/BloodHound.py/">BloodHound.py GitHub</a><td style="text-align: left">Python implementation of SharpHound<tr><td style="text-align: left">ADExplorerSnapshot.py<td style="text-align: center">Python<td style="text-align: left"><a href="https://github.com/c3c/ADExplorerSnapshot.py/">ADExplorerSnapshot.py GitHub</a><td style="text-align: left">Converts Sysinternals ADExplorer snapshots into BloodHound compatible JSON files<tr><td style="text-align: left">BOFHound<td style="text-align: center">Python<td style="text-align: left"><a href="https://github.com/fortalice/bofhound/">BOFHound GitHub</a><td style="text-align: left">Converts logs from ldapsearch BOF and pyldapsearch into BloodHound compatible JSON files</table></div><p>Once the necessary input files are gathered, we can move on to the next step: importing the files into BloodHound.</p><h2 id="importing"><span class="me-2">Importing</span><a href="#importing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After setting up BloodHound with Neo4j’s database backend, as detailed in the Installation section at <a href="https://bloodhound.readthedocs.io/">BloodHound Docs</a>, the gathered data can be imported.</p><p>The standard method of importing is simply starting the BloodHound GUI and dragging the JSON and/or zip files onto the application’s main window. Alternatively, the Import button on the right can be used to select the files you wish to import.</p><p>During the import process, BloodHound reads the JSON data and translates them into Cypher <code class="language-plaintext highlighter-rouge">CREATE</code> commands that create the various nodes and edges in the Neo4j graph database. Nodes represent objects such as <code class="language-plaintext highlighter-rouge">Computers</code>, <code class="language-plaintext highlighter-rouge">Users</code>, <code class="language-plaintext highlighter-rouge">Groups</code>, <code class="language-plaintext highlighter-rouge">GPOs</code>, etc., with their respective attributes, while edges represent relationships like <code class="language-plaintext highlighter-rouge">MemberOf</code>, <code class="language-plaintext highlighter-rouge">Owns</code>, <code class="language-plaintext highlighter-rouge">WriteDacl</code>, <code class="language-plaintext highlighter-rouge">CanRDP</code>, etc.</p><p>Importing generally works well, but sometimes it fails. In such cases, trying a different BloodHound version might magically solve the import issues. Multiple BloodHound versions can be installed side-by-side. If files still won’t import, there might be some other underlying problem.</p><h2 id="mock-data"><span class="me-2">Mock Data</span><a href="#mock-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote class="prompt-tip"><p>If you don’t have access to an Active Directory environment but still want to perform Cypher queries (discussed in the Queries section), you can also load some mock data into BloodHound using one of the two methods below.</p></blockquote><h3 id="option-1---using-the-dbcreatorpy-tool-which-can-be-installed-as-follows"><span class="me-2">Option 1 - Using the DBCreator.py tool, which can be installed as follows:</span><a href="#option-1---using-the-dbcreatorpy-tool-which-can-be-installed-as-follows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>git clone https://github.com/BloodHoundAD/BloodHound-Tools/
<span class="nb">cd </span>BloodHound-Tools/DBCreator
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</pre></table></code></div></div><p>Once installed, simply start the script to open an interactive prompt. In this prompt, the <code class="language-plaintext highlighter-rouge">dbconfig</code> command can be used to set up the URL, username, and password for your Neo4j instance. After this configuration, connect to the database using the <code class="language-plaintext highlighter-rouge">connect</code> command. To generate and insert mock data, use the <code class="language-plaintext highlighter-rouge">generate</code> command.</p><h3 id="option-2---importing-from-the-neo4j-database"><span class="me-2">Option 2 - Importing from the Neo4J database:</span><a href="#option-2---importing-from-the-neo4j-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Source:</em> https://github.com/BloodHoundAD/BloodHound/issues/336</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">cd</span> /tmp/
curl <span class="nt">-LO</span> https://github.com/BloodHoundAD/BloodHound/archive/ec277d027cb2cf1e690c3afeb437f9f7fae39fef.zip
unzip ec277d027cb2cf1e690c3afeb437f9f7fae39fef.zip
<span class="nv">DATA</span><span class="o">=</span><span class="si">$(</span><span class="nb">grep</span> <span class="nt">-oE</span> <span class="s1">'^dbms.directories.data[ =]{1,3}(.*)$'</span> /etc/neo4j/neo4j.conf | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'='</span> <span class="nt">-f2</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">' '</span><span class="si">)</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DATA</span><span class="k">}</span><span class="s2">/databases/bloodhoundexampledb.db"</span>
<span class="nb">rm</span> <span class="nt">-rf</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DATA</span><span class="k">}</span><span class="s2">/transactions/bloodhoundexampledb.db/"</span>
rsync <span class="nt">-av</span> BloodHound-ec277d027cb2cf1e690c3afeb437f9f7fae39fef/BloodHoundExampleDB.db/<span class="k">*</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DATA</span><span class="k">}</span><span class="s2">/databases/bloodhoundexampledb.db"</span>
</pre></table></code></div></div><p>Edit the configuration file <code class="language-plaintext highlighter-rouge">/etc/neo4j/neo4j.conf</code>, and include/edit the line below:</p><div file="/etc/neo4j/neo4j.conf" class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/neo4j/neo4j.conf"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>dbms.default_database<span class="o">=</span>bloodhoundexampledb.db
dbms.databases.allow_upgrade<span class="o">=</span><span class="nb">true</span>
</pre></table></code></div></div><p>Restart Neo4J.</p><h2 id="large-filesenvironments"><span class="me-2">Large Files/Environments</span><a href="#large-filesenvironments" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I frequently encounter large AD environments during my tests, which subsequently produce large volumes of data and correspondingly large JSON files. As mentioned above, the standard method of import is to start the BloodHound GUI and drag the JSON and/or zip files onto the main app window. However, due to the way the importer is structured and designed, it consumes a significant amount of memory and is extremely slow, especially with larger files.</p><p>My first attempt to address the import problem was to use the <a href="https://github.com/fox-it/bloodhound-import">bloodhound-importer.py</a> script. However, it currently only supports the BloodHound v3 data format, while the files we generate are usually from newer versions (typically v4 or higher).</p><p>I later found out that the file format doesn’t differ much, but initially, I looked for other solutions to my problem. I came across the original article (<a href="https://blog.bitsadmin.com/dealing-with-large-bloodhound-datasets">Dealing with large BloodHound datasets</a>), written by Arris Huijgen, which I used as a basis for this post. The author basically splits the JSON file into several smaller ones. This strategy didn’t help me much since I still faced import slowness issues.</p><h2 id="creation-of-knowsmore"><span class="me-2">Creation of KnowsMore</span><a href="#creation-of-knowsmore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Given the import slowness and solutions that weren’t much help, I decided to delve deeper into the structure of the JSON files and create my own importer.</p><p>During my penetration tests</p><p>, I always follow the procedure below after compromising the AD:</p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Extract all hashes using <code class="language-plaintext highlighter-rouge">ntds.dit</code> or <code class="language-plaintext highlighter-rouge">DCSync</code>;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Create a custom wordlist with the client’s name (including common passwords, e.g., <code class="language-plaintext highlighter-rouge">Client@2023</code>);<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Crack the hashes (using hashcat) with the <code class="language-plaintext highlighter-rouge">custom wordlist</code> + <code class="language-plaintext highlighter-rouge">passwords found during the test</code> + common market <code class="language-plaintext highlighter-rouge">wordlists</code> (listed below).</ul><p><strong>My favorite wordlists</strong></p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Custom wordlist created with the command <code class="language-plaintext highlighter-rouge">knowsmore --word-list -o my_list.txt --batch --name sec4us</code>;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i><a href="https://weakpass.com/wordlist/1851">hashesorg2019</a>;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i><a href="https://weakpass.com/wordlist/1863">weakpass_2</a>.</ul><p>I always do this to generate data on the client’s general security/entropy status. Even though it’s a simple task, clients are always surprised and love this information.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>[?] General Statistics
+-------+----------------+-------+
|   top | description    |   qty |
|-------+----------------+-------|
|     1 | Total Users    | 95369 |
|     2 | Unique Hashes  | 74299 |
|     3 | Cracked Hashes | 23177 |
|     4 | Cracked Users  | 35078 |
+-------+----------------+-------+

[?] General Top 10 passwords
+-------+-------------+-------+
|   top | password    |   qty |
|-------+-------------+-------|
|     1 | password    |  1111 |
|     2 | 123456      |   824 |
|     3 | 123456789   |   815 |
|     4 | guest       |   553 |
|     5 | qwerty      |   329 |
|     6 | 12345678    |   277 |
|     7 | 111111      |   268 |
|     8 | 12345       |   202 |
|     9 | secret      |   170 |
|    10 | sec4us      |   165 |
+-------+-------------+-------+

[?] Top 10 weak passwords by company name similarity
+-------+--------------+---------+----------------------+-------+
|   top | password     |   score |   company_similarity |   qty |
|-------+--------------+---------+----------------------+-------|
|     1 | company123   |    7024 |                   80 |  1111 |
|     2 | Company123   |    5209 |                   80 |   824 |
|     3 | company      |    3674 |                  100 |   553 |
|     4 | Company@10   |    2080 |                   80 |   329 |
|     5 | company10    |    1722 |                   86 |   268 |
|     6 | Company@2022 |    1242 |                   71 |   202 |
|     7 | Company@2024 |    1015 |                   71 |   165 |
|     8 | Company2022  |     978 |                   75 |   157 |
|     9 | Company10    |     745 |                   86 |   116 |
|    10 | Company21    |     707 |                   86 |   110 |
+-------+--------------+---------+----------------------+-------+
</pre></table></code></div></div><p>It was at this point that I decided to aggregate BloodHound data in the same tool, allowing clients to verify information such as weak passwords pointed out in a previous report that haven’t yet been changed (since one of the data points from BloodHound indicates the date of password change).</p><h2 id="knowsmore"><span class="me-2">KnowsMore</span><a href="#knowsmore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>During the development of KnowsMore, various challenges arose:</p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Gaining an up-to-date understanding of how data is imported and related (as the importer creates the nodes and edges);<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Handling non-ASCII characters in the JSON (which broke the import);<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Working with large files;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Dealing with different versions of collectors (v3, v4), since minor differences appear in the JSON files between versions.</ul><p>As a result, I heavily based my research on the BloodHound’s source code, particularly the <a href="https://github.com/BloodHoundAD/BloodHound/blob/master/src/js/utils.js">util.js</a> file, to create my own importer. I laid out the following criteria for the importer:</p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Fast (because slow speed was the main issue that motivated me);<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Import data accurately (to avoid missing potential compromise paths due to a software fault</ul><p>);</p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Backwards compatible with at least one previous version (v3, for example, if using v4);<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>As an enhancement, have the ability to import cracked passwords from the <code class="language-plaintext highlighter-rouge">ntds.dit</code> file and relate this data with BloodHound.</ul><p>I followed a procedure similar to the standard BloodHound import process, using the same node and edge creation Cypher queries. However, I developed a multithreaded importer with Python that chunks and processes data simultaneously, ultimately producing a noticeable speed increase. As a bonus, my importer auto-detects the BloodHound version and correctly processes the data accordingly.</p><p>The tool processes the standard collections (Group, Session, Trusts, and ACL) and the corresponding JSON or ZIP files. The processing is done as follows:</p><ul><li><strong>For Groups:</strong> Import the <code class="language-plaintext highlighter-rouge">users</code>, <code class="language-plaintext highlighter-rouge">computers</code>, and <code class="language-plaintext highlighter-rouge">groups</code> data;<li><strong>For Sessions:</strong> Import the <code class="language-plaintext highlighter-rouge">users</code>, <code class="language-plaintext highlighter-rouge">computers</code>, <code class="language-plaintext highlighter-rouge">groups</code>, and <code class="language-plaintext highlighter-rouge">sessions</code> data;<li><strong>For Trusts:</strong> Import the <code class="language-plaintext highlighter-rouge">domains</code> and <code class="language-plaintext highlighter-rouge">trusts</code> data;<li><strong>For ACLs:</strong> Import the <code class="language-plaintext highlighter-rouge">users</code>, <code class="language-plaintext highlighter-rouge">computers</code>, <code class="language-plaintext highlighter-rouge">groups</code>, <code class="language-plaintext highlighter-rouge">aces</code>, and <code class="language-plaintext highlighter-rouge">gpos</code> data.</ul><p>In addition to the above, <code class="language-plaintext highlighter-rouge">KnowsMore</code> has a unique feature: It can associate cracked hashes from an <code class="language-plaintext highlighter-rouge">ntds.dit</code> dump with their corresponding user nodes in the BloodHound database. The process to achieve this is as follows:</p><ul class="task-list"><li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Dump the <code class="language-plaintext highlighter-rouge">ntds.dit</code> database using a tool like <code class="language-plaintext highlighter-rouge">mimikatz</code> or <code class="language-plaintext highlighter-rouge">secretsdump.py</code>;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Crack the hashes using <code class="language-plaintext highlighter-rouge">hashcat</code> or another similar tool;<li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Use <code class="language-plaintext highlighter-rouge">KnowsMore</code> to associate the cracked passwords with their respective nodes.</ul><p>The <code class="language-plaintext highlighter-rouge">KnowsMore</code> tool, when associating passwords, will also calculate password entropy and compare them against common weak passwords, identifying users with weak credentials. This information will then be shown in the Neo4j graph, providing a holistic overview of an organization’s AD security posture.</p><h2 id="how-to-use-knowsmore"><span class="me-2">How to Use KnowsMore</span><a href="#how-to-use-knowsmore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To use the <code class="language-plaintext highlighter-rouge">KnowsMore</code> tool, follow the steps below:</p><ol><li><p><strong>Data Collection</strong>: Gather data from the Active Directory using one of the collectors mentioned earlier in the article.</p><li><p><strong>Setting up KnowsMore</strong>: Clone the <code class="language-plaintext highlighter-rouge">KnowsMore</code> repository and set it up.</p></ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>git clone https://github.com/username/knowsmore.git
<span class="nb">cd </span>knowsmore
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</pre></table></code></div></div><ol><li><strong>Importing Data with KnowsMore</strong>:</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python knowsmore.py <span class="nt">--file</span> /path/to/data.zip <span class="nt">--neo4j-url</span> bolt://localhost:7687 <span class="nt">--neo4j-user</span> neo4j <span class="nt">--neo4j-pass</span> password
</pre></table></code></div></div><p>Optionally, if you want to incorporate cracked hashes:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python knowsmore.py <span class="nt">--file</span> /path/to/data.zip <span class="nt">--ntds</span> /path/to/cracked_ntds.txt <span class="nt">--neo4j-url</span> bolt://localhost:7687 <span class="nt">--neo4j-user</span> neo4j <span class="nt">--neo4j-pass</span> password
</pre></table></code></div></div><ol><li><strong>Analyzing Data</strong>: After importing the data, start the BloodHound interface and begin your analysis.</ol><p>The <code class="language-plaintext highlighter-rouge">KnowsMore</code> tool effectively reduces the time required to import large datasets, ensuring you can quickly and effectively identify potential compromise paths in large AD environments. Additionally, the ability to integrate cracked password hashes directly into the graph provides an invaluable feature for red teams, security assessors, and even blue teams, giving a comprehensive view of the organization’s AD security posture.</p><h3 id="installing-knowsmore"><span class="me-2">Installing KnowsMore</span><a href="#installing-knowsmore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip3 <span class="nb">install</span> <span class="nt">--upgrade</span> knowsmore
</pre></table></code></div></div><h3 id="creating-a-local-database"><span class="me-2">Creating a local database</span><a href="#creating-a-local-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>knowsmore <span class="nt">--create-db</span>
</pre></table></code></div></div><h3 id="importing-json-files"><span class="me-2">Importing JSON files</span><a href="#importing-json-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Although you can import a JSON file directly, I recommend doing the import through the entire ZIP file, as KnowsMore will optimize the import order aiming for a better correlation of data.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Bloodhound ZIP File</span>
knowsmore <span class="nt">--bloodhound</span> <span class="nt">--import-data</span> ~/Desktop/client.zip

<span class="c"># Bloodhound JSON File</span>
knowsmore <span class="nt">--bloodhound</span> <span class="nt">--import-data</span> ~/Desktop/20220912105336_users.json
</pre></table></code></div></div><h3 id="exporting-synchronizing-data-to-bloodhounds-neo4j-database"><span class="me-2">Exporting (synchronizing) data to BloodHound’s Neo4J database</span><a href="#exporting-synchronizing-data-to-bloodhounds-neo4j-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>knowsmore <span class="nt">--bloodhound</span> <span class="nt">--sync</span> 10.10.10.10:7687 <span class="nt">-d</span> neo4j <span class="nt">-u</span> neo4j <span class="nt">-p</span> 12345678
</pre></table></code></div></div><blockquote class="prompt-warning"><p>In order for you to interact with Neo4J remotely, you need to change your configuration file <code class="language-plaintext highlighter-rouge">/etc/neo4j/neo4j.conf</code> as shown below and restart its service.</p></blockquote><div file="/etc/neo4j/neo4j.conf" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/neo4j/neo4j.conf"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>server.bolt.listen_address=0.0.0.0:7687
</pre></table></code></div></div><h3 id="marking-a-user-as-compromised"><span class="me-2">Marking a user as compromised</span><a href="#marking-a-user-as-compromised" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Regardless of how, once you’ve identified a user’s password, you can inform KnowsMore that this user has been compromised using the command below:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>knowsmore <span class="nt">--user-pass</span> <span class="nt">--username</span> administrator <span class="nt">--password</span> Sec4US@2023

<span class="c"># or by adding the company name</span>
knowsmore <span class="nt">--user-pass</span> <span class="nt">--username</span> administrator <span class="nt">--password</span> Sec4US@2023 <span class="nt">--company</span> sec4us
</pre></table></code></div></div><p>Subsequently, it’s possible to synchronize with Neo4J</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>knowsmore <span class="nt">--bloodhound</span> <span class="nt">--mark-owned</span> 10.10.10.10 <span class="nt">-d</span> neo4j <span class="nt">-u</span> neo4j <span class="nt">-p</span> 123456
</pre></table></code></div></div><h2 id="multiple-databases"><span class="me-2">Multiple databases</span><a href="#multiple-databases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You may be working on several tasks for which you are using BloodHound. Although it is possible to simply import the domains of all the assignments into a single database and query the data individually, this can become slow and confusing quickly.</p><p>For this reason, it’s helpful to use multiple Neo4j databases. This is possible simply by using different database folders for different projects, which can be done using the steps below. This procedure works in both Windows and Linux environments.</p><ol><li>Stop the neo4j service in an elevated command prompt:<ul><li>Windows: <code class="language-plaintext highlighter-rouge">net stop neo4j</code> (PowerShell: <code class="language-plaintext highlighter-rouge">Stop-Service neo4j</code>)<li>Linux: <code class="language-plaintext highlighter-rouge">systemctl stop neo4j</code></ul><li>Navigate to the <code class="language-plaintext highlighter-rouge">data\databases</code> folder inside the Neo4j installation directory<ul><li>Windows: <code class="language-plaintext highlighter-rouge">c:\Program Files\Neo4j</code><li>Linux: check with the command <code class="language-plaintext highlighter-rouge">grep -oE '^dbms.directories.data[ =]{1,3}(.*)$' /etc/neo4j/neo4j.conf | cut -d'=' -f2 | tr -d ' '</code></ul><li>Rename the existing <code class="language-plaintext highlighter-rouge">graph.db</code> folder to something else, for example <code class="language-plaintext highlighter-rouge">graph.db-ProjectX</code><li>Start the neo4j service again using the commands below; a new graph.db folder will be created automatically<ul><li>Windows: <code class="language-plaintext highlighter-rouge">net start neo4j</code> (PowerShell: <code class="language-plaintext highlighter-rouge">Start-Service neo4j</code>)<li>Linux: <code class="language-plaintext highlighter-rouge">systemctl start neo4j</code></ul><li>Import your data into this clean database. Whenever you want to switch back, follow these steps again by renaming the existing graph.db folder to, for instance, <code class="language-plaintext highlighter-rouge">graph.db-ProjectY</code> and renaming the previously renamed folder back to <code class="language-plaintext highlighter-rouge">graph.db</code></ol><p>An alternative way to switch between databases is to uncomment and update the line <code class="language-plaintext highlighter-rouge">dbms.active_database=graph.db</code> in the <code class="language-plaintext highlighter-rouge">neo4j.conf</code> file within Neo4j’s configuration directory. A third option is to start multiple instances of Neo4j using Docker, as described on the <a href="https://neo4j.com/developer/docker/">Neo4j with Docker</a> page in the Neo4j developer documentation.</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>BloodHound is a very powerful tool for attackers and defenders to identify unintentional paths in Active Directory environments. This is facilitated by the Neo4j graph database, which can be queried directly using Cypher to efficiently extract and post-process any information so that it can be used by attackers, administrators, and defenders to escalate the continuous game of attack and defense.</p><p>In summary, <code class="language-plaintext highlighter-rouge">KnowsMore</code> not only tackles the main challenge of “slow data import in BloodHound” but also enhances the BloodHound experience by integrating additional valuable data. It’s a must-have for anyone regularly working with BloodHound and large AD datasets.</p><p>The KnowsMore source code can be found on my GitHub</p><p><a href="https://github.com/helviojunior/knowsmore">https://github.com/helviojunior/knowsmore</a></p><p>Thank you for reading, and I hope you can use some of the tricks in your future Active Directory assignments!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/offensive-security/'>Offensive Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/offensive-security/" class="post-tag no-text-decoration" >Offensive Security</a> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >Active Directory</a> <a href="/tags/osep/" class="post-tag no-text-decoration" >OSEP</a> <a href="/tags/bloodhound/" class="post-tag no-text-decoration" >BloodHound</a> <a href="/tags/active-directory-exploitation/" class="post-tag no-text-decoration" >Active Directory Exploitation</a> <a href="/tags/pentest/" class="post-tag no-text-decoration" >Pentest</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Dealing with large BloodHound datasets - Helvio Junior&url=https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Dealing with large BloodHound datasets - Helvio Junior&u=https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Dealing with large BloodHound datasets - Helvio Junior&url=https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/security/osint/localizando-ips-que-respondem-para-uma-url/">Localizando IPs que respondem para uma URL</a><li><a href="/security/osint/locating-url-ips-bypass-waf/">Locating IPs that respond to a URL</a><li><a href="/security/edr/instalando-elasticsearch-edr/">Instalando Elasticsearch EDR</a><li><a href="/it/instalando-openvpn-com-autenticacao-em-mysql/">Instalando OpenVPN com autenticação em MySQL</a><li><a href="/it/osce-osed-e-ecxd-certificacoes-de-desenvolvimento-de-exploits/">OSCE, OSED e eCXD: Certificações de desenvolvimento de Exploits</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/offsec/gerenciando-grandes-bases-do-bloodhound/"><div class="card-body"> <span class="timeago small" > Aug 21, 2023 <i class="unloaded">2023-08-21T23:30:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Gerenciando grandes bases de dados do BloodHound</h3><div class="text-muted small"><p> Introdução Muito comumente durante um teste de invasão (Pentest) que envolve ambiente do Microsoft Active Directory (aka AD), utilizamos diversas ferramentas para automatizar e transformar um dado...</p></div></div></a></div><div class="card"> <a href="/it/oswe-uma-historia-de-insucessos/"><div class="card-body"> <span class="timeago small" > Dec 29, 2020 <i class="unloaded">2020-12-29T21:31:52-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSWE - Uma história de insucessos!</h3><div class="text-muted small"><p> Minha Jornada para a Certificação OSWE Estamos vivendo em um ano que certamente ficará marcado na história da humanidade, mas de forma especial na vida de muitos de nós. Desta forma, decidi escrev...</p></div></div></a></div><div class="card"> <a href="/it/security/criacao-de-exploits/shellcoding-encontrando-endereco-da-funcao-dinamicamente-analise-da-biblioteca-block_api/"><div class="card-body"> <span class="timeago small" > Aug 15, 2021 <i class="unloaded">2021-08-15T16:26:52-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shellcoding - Encontrando endereço da função dinamicamente. Análise da biblioteca block_api</h3><div class="text-muted small"><p> Introdução Neste artigo iremos dissecar a biblioteca da Metasploit chamada Block API responsável por localizar em tempo de execução o endereço das funções dentro dos módulos carregados na aplicaçã...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/it/osce-osed-e-ecxd-certificacoes-de-desenvolvimento-de-exploits/" class="btn btn-outline-primary" prompt="Older"><p>OSCE, OSED e eCXD: Certificações de desenvolvimento de Exploits</p></a> <a href="/offsec/gerenciando-grandes-bases-do-bloodhound/" class="btn btn-outline-primary" prompt="Newer"><p>Gerenciando grandes bases de dados do BloodHound</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Dealing with large BloodHound datasets'; this.page.url = 'https://www.helviojunior.com.br/en/offsec/dealing-with-large-bloodHound-datasets/'; this.page.identifier = '/en/offsec/dealing-with-large-bloodHound-datasets/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/helviojunior">Helvio junior (aka M4v3r1ck)</a>. <span data-toggle="tooltip" data-placement="top" title="Some rights reserved.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.helviojunior.com.br{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
