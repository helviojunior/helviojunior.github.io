<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Resgatando IP válido do agente zabbix" /><meta name="author" content="Helvio Junior (m4v3r1ck)" /><meta property="og:locale" content="en_US" /><meta name="description" content="Em uma das construtivas discuções do grupo Zabbix Brasil (Blog | Yahoo), foi levantado a necessidade de obter o IP válido dos agentes ou dos proxies em caso de ambiente com IP dinâmico. Uma das soluções possíveis para resolver este problema foi proposta pelo membro do grupo Igor Araujo, esta solução consiste em criar uma página no proprio servidor apache do zabbix server que retorne o IP em que o agente está conectando e utilizar esta URL pelo agente que por sua vez irá obter o seu próprio IP e informa-lo ao Zabbix server. Chega de lero, lero e vamos ao passo a passo desta solução. Criando a página no apache Localize o diretório onde estão os arquivos do front-end (web) do zabbix, no meu ambiente está em /usr/share/zabbix.  Crie um subdiretório dentro deste com o nome ip [sourcecode language=&quot;shell&quot;]mkdir /usr/share/zabbix/ip [/sourcecode] Crie um arquivo nomeado /usr/share/zabbix/ip/index.php com o seguinte conteúdo [sourcecode language=&quot;php&quot;]&lt;?php $ip = $_SERVER[&#39;REMOTE_ADDR&#39;]; echo $ip; ?&gt; [/sourcecode] Caso as permissões dos seus arquivos web estejam para outro usuário que não o root, defina as permissões para o usuário especificado. Realize o teste de acesso com a url do seu servidor web ex.: http://meuservidor.com.br/zabbix/ip/ Configurando o agente O Zabbix suporta diversos sistemas operacional como cliente (Linux, Windows MAC e etc...), porem para o objetivo deste tutorial a unica diferença entre eles será a forma de instalação do aplicativo cURL e o caminho de chamada deste na configuração do agente,  desta forma serão mostrados como realizar em windows e linux. Linux Instale o aplicativo cURL através do comando [sourcecode language=&quot;shell&quot;]apt-get install curl[/sourcecode] Windows e outras plataformas Realize o download do executável do aplicativo no site oficial do fabricante (http://curl.haxx.se/download.html) Descompacte o executável no mesmo diretório de instalação do agente do zabbix. No meu ambiente é c:\zabbix. Este aplicativo terá a função de acessar a url que criamos no servidor e extrair somente o ip, para isso a sintaze de execução é curl -s url, onde o -s extrai todo o cabeçalho http deixando somente o conteúdo. Edite o arquivo de configuração do agente zabbix (zabbix_agentd.conf) e adicione as seguintes linhas Para linux [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Para windows [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,c:\zabbix\commands\curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Reinicie o agente Criando o item de nomitoramento no Host no zabbix Vá no host desejado, clique em Items e clique em Novo Item Cadastre o novo item conforme informações abaixo: Key: net.ipaddress Type of information: Text Update interval: 180 Quanto ao item Update interval vale a pena considerar qual é o tempo ideal para o seu ambiente para não sobrecarregar o seu servidor do zabbix. Basta salvar o item que automaticamente o IP do host será capturado na próxima verificação." /><meta property="og:description" content="Em uma das construtivas discuções do grupo Zabbix Brasil (Blog | Yahoo), foi levantado a necessidade de obter o IP válido dos agentes ou dos proxies em caso de ambiente com IP dinâmico. Uma das soluções possíveis para resolver este problema foi proposta pelo membro do grupo Igor Araujo, esta solução consiste em criar uma página no proprio servidor apache do zabbix server que retorne o IP em que o agente está conectando e utilizar esta URL pelo agente que por sua vez irá obter o seu próprio IP e informa-lo ao Zabbix server. Chega de lero, lero e vamos ao passo a passo desta solução. Criando a página no apache Localize o diretório onde estão os arquivos do front-end (web) do zabbix, no meu ambiente está em /usr/share/zabbix.  Crie um subdiretório dentro deste com o nome ip [sourcecode language=&quot;shell&quot;]mkdir /usr/share/zabbix/ip [/sourcecode] Crie um arquivo nomeado /usr/share/zabbix/ip/index.php com o seguinte conteúdo [sourcecode language=&quot;php&quot;]&lt;?php $ip = $_SERVER[&#39;REMOTE_ADDR&#39;]; echo $ip; ?&gt; [/sourcecode] Caso as permissões dos seus arquivos web estejam para outro usuário que não o root, defina as permissões para o usuário especificado. Realize o teste de acesso com a url do seu servidor web ex.: http://meuservidor.com.br/zabbix/ip/ Configurando o agente O Zabbix suporta diversos sistemas operacional como cliente (Linux, Windows MAC e etc...), porem para o objetivo deste tutorial a unica diferença entre eles será a forma de instalação do aplicativo cURL e o caminho de chamada deste na configuração do agente,  desta forma serão mostrados como realizar em windows e linux. Linux Instale o aplicativo cURL através do comando [sourcecode language=&quot;shell&quot;]apt-get install curl[/sourcecode] Windows e outras plataformas Realize o download do executável do aplicativo no site oficial do fabricante (http://curl.haxx.se/download.html) Descompacte o executável no mesmo diretório de instalação do agente do zabbix. No meu ambiente é c:\zabbix. Este aplicativo terá a função de acessar a url que criamos no servidor e extrair somente o ip, para isso a sintaze de execução é curl -s url, onde o -s extrai todo o cabeçalho http deixando somente o conteúdo. Edite o arquivo de configuração do agente zabbix (zabbix_agentd.conf) e adicione as seguintes linhas Para linux [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Para windows [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,c:\zabbix\commands\curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Reinicie o agente Criando o item de nomitoramento no Host no zabbix Vá no host desejado, clique em Items e clique em Novo Item Cadastre o novo item conforme informações abaixo: Key: net.ipaddress Type of information: Text Update interval: 180 Quanto ao item Update interval vale a pena considerar qual é o tempo ideal para o seu ambiente para não sobrecarregar o seu servidor do zabbix. Basta salvar o item que automaticamente o IP do host será capturado na próxima verificação." /><link rel="canonical" href="https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" /><meta property="og:url" content="https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" /><meta property="og:site_name" content="Helvio Junior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2013-07-20T10:47:17-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Resgatando IP válido do agente zabbix" /><meta name="twitter:site" content="@helvioju" /><meta name="twitter:creator" content="@Helvio Junior (m4v3r1ck)" /><meta name="google-site-verification" content="JR4IIP9jfvOwxn2ybV_Qn0SrtDPlTrKomdPWgBuP55k"" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Helvio Junior (m4v3r1ck)"},"dateModified":"2023-08-17T00:19:29-03:00","datePublished":"2013-07-20T10:47:17-03:00","description":"Em uma das construtivas discuções do grupo Zabbix Brasil (Blog | Yahoo), foi levantado a necessidade de obter o IP válido dos agentes ou dos proxies em caso de ambiente com IP dinâmico. Uma das soluções possíveis para resolver este problema foi proposta pelo membro do grupo Igor Araujo, esta solução consiste em criar uma página no proprio servidor apache do zabbix server que retorne o IP em que o agente está conectando e utilizar esta URL pelo agente que por sua vez irá obter o seu próprio IP e informa-lo ao Zabbix server. Chega de lero, lero e vamos ao passo a passo desta solução. Criando a página no apache Localize o diretório onde estão os arquivos do front-end (web) do zabbix, no meu ambiente está em /usr/share/zabbix.  Crie um subdiretório dentro deste com o nome ip [sourcecode language=&quot;shell&quot;]mkdir /usr/share/zabbix/ip [/sourcecode] Crie um arquivo nomeado /usr/share/zabbix/ip/index.php com o seguinte conteúdo [sourcecode language=&quot;php&quot;]&lt;?php $ip = $_SERVER[&#39;REMOTE_ADDR&#39;]; echo $ip; ?&gt; [/sourcecode] Caso as permissões dos seus arquivos web estejam para outro usuário que não o root, defina as permissões para o usuário especificado. Realize o teste de acesso com a url do seu servidor web ex.: http://meuservidor.com.br/zabbix/ip/ Configurando o agente O Zabbix suporta diversos sistemas operacional como cliente (Linux, Windows MAC e etc...), porem para o objetivo deste tutorial a unica diferença entre eles será a forma de instalação do aplicativo cURL e o caminho de chamada deste na configuração do agente,  desta forma serão mostrados como realizar em windows e linux. Linux Instale o aplicativo cURL através do comando [sourcecode language=&quot;shell&quot;]apt-get install curl[/sourcecode] Windows e outras plataformas Realize o download do executável do aplicativo no site oficial do fabricante (http://curl.haxx.se/download.html) Descompacte o executável no mesmo diretório de instalação do agente do zabbix. No meu ambiente é c:\\zabbix. Este aplicativo terá a função de acessar a url que criamos no servidor e extrair somente o ip, para isso a sintaze de execução é curl -s url, onde o -s extrai todo o cabeçalho http deixando somente o conteúdo. Edite o arquivo de configuração do agente zabbix (zabbix_agentd.conf) e adicione as seguintes linhas Para linux [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Para windows [sourcecode language=&quot;shell&quot;]#Endereço IP WAN UserParameter=net.ipaddress,c:\\zabbix\\commands\\curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode] Reinicie o agente Criando o item de nomitoramento no Host no zabbix Vá no host desejado, clique em Items e clique em Novo Item Cadastre o novo item conforme informações abaixo: Key: net.ipaddress Type of information: Text Update interval: 180 Quanto ao item Update interval vale a pena considerar qual é o tempo ideal para o seu ambiente para não sobrecarregar o seu servidor do zabbix. Basta salvar o item que automaticamente o IP do host será capturado na próxima verificação.","headline":"Resgatando IP válido do agente zabbix","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/"},"url":"https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/"}</script><title>Resgatando IP válido do agente zabbix | Helvio Junior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Helvio Junior"><meta name="application-name" content="Helvio Junior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/m4v3r1ck.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Helvio Junior</a></div><div class="site-subtitle font-italic">Cyber security researcher, speaker, low level and binary exploitation entusiast. <br /><br />"I’m just a child who has never grown up. I still keep asking these 'how' & 'why' questions. Occasionally, I find an answer. Stephen Hawking"</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://www.linkedin.com/in/helviojunior" aria-label="linkedin" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/@Sec4US" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/helviojunior" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['helvio.junior','sec4us.com.br'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/it"> It </a> </span> <span>Resgatando IP válido do agente zabbix</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Resgatando IP válido do agente zabbix</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Helvio Junior (m4v3r1ck) </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 20, 2013, 10:47 AM -0300" prep="on" > Jul 20, 2013 <i class="unloaded">2013-07-20T10:47:17-03:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 17, 2023, 12:19 AM -0300" prefix="Updated " > Aug 17, 2023 <i class="unloaded">2023-08-17T00:19:29-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="445 words">2 min</span></div></div><div class="post-content"><p>Em uma das construtivas discuções do grupo Zabbix Brasil (<a href="http://zabbixbrasil.org/">Blog </a>| <a href="http://br.groups.yahoo.com/group/zabbix-brasil/">Yahoo</a>), foi levantado a necessidade de obter o IP válido dos agentes ou dos proxies em caso de ambiente com IP dinâmico.</p><p>Uma das soluções possíveis para resolver este problema foi proposta pelo membro do grupo Igor Araujo, esta solução consiste em criar uma página no proprio servidor apache do zabbix server que retorne o IP em que o agente está conectando e utilizar esta URL pelo agente que por sua vez irá obter o seu próprio IP e informa-lo ao Zabbix server.</p><p></p><p>Chega de lero, lero e vamos ao passo a passo desta solução.</p><p><strong>Criando a página no apache</strong></p><p>Localize o diretório onde estão os arquivos do front-end (web) do zabbix, no meu ambiente está em <strong>/usr/share/zabbix. </strong></p><p>Crie um subdiretório dentro deste com o nome <strong>ip</strong></p><p>[sourcecode language="shell"]mkdir /usr/share/zabbix/ip<br /> [/sourcecode]</p><p>Crie um arquivo nomeado <strong>/usr/share/zabbix/ip/index.php</strong> com o seguinte conteúdo</p><p>[sourcecode language="php"]&lt;?php<br /> $ip = $_SERVER['REMOTE_ADDR'];<br /> echo $ip;<br /> ?&gt;<br /> [/sourcecode]</p><p>Caso as permissões dos seus arquivos web estejam para outro usuário que não o root, defina as permissões para o usuário especificado.</p><p>Realize o teste de acesso com a url do seu servidor web ex.: http://meuservidor.com.br/zabbix/ip/</p><p><a href="/assets/2013/07/IP_001.png" class="img-link shimmer" ><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 364 111'%3E%3C/svg%3E" alt="IP_001" data-src="/assets/2013/07/IP_001.png" width="364" height="111" class="lazyload" data-proofer-ignore></a></p><p><strong>Configurando o agente</strong></p><p>O Zabbix suporta diversos sistemas operacional como cliente (Linux, Windows MAC e etc...), porem para o objetivo deste tutorial a unica diferença entre eles será a forma de instalação do aplicativo cURL e o caminho de chamada deste na configuração do agente,  desta forma serão mostrados como realizar em windows e linux.</p><p>Linux</p><p>Instale o aplicativo cURL através do comando</p><p>[sourcecode language="shell"]apt-get install curl[/sourcecode]</p><p>Windows e outras plataformas</p><p>Realize o download do executável do aplicativo no site oficial do fabricante (http://curl.haxx.se/download.html)</p><p>Descompacte o executável no mesmo diretório de instalação do agente do zabbix. No meu ambiente é c:\zabbix.</p><p>Este aplicativo terá a função de acessar a url que criamos no servidor e extrair somente o ip, para isso a sintaze de execução é curl -s url, onde o -s extrai todo o cabeçalho http deixando somente o conteúdo.</p><p>Edite o arquivo de configuração do agente zabbix (zabbix_agentd.conf) e adicione as seguintes linhas</p><p>Para linux</p><p>[sourcecode language="shell"]#Endereço IP WAN<br /> UserParameter=net.ipaddress,curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode]</p><p>Para windows</p><p>[sourcecode language="shell"]#Endereço IP WAN<br /> UserParameter=net.ipaddress,c:\zabbix\commands\curl -s http://meuservidor.com.br/zabbix/ip/[/sourcecode]</p><p>Reinicie o agente</p><p><strong>Criando o item de nomitoramento no Host no zabbix</strong></p><p>Vá no host desejado, clique em Items e clique em Novo Item</p><p>Cadastre o novo item conforme informações abaixo:</p><ul><li><span style="line-height: 13px;">Key: net.ipaddress</span><li>Type of information: Text<li>Update interval: 180</ul><p>Quanto ao item <strong>Update interval</strong> vale a pena considerar qual é o tempo ideal para o seu ambiente para não sobrecarregar o seu servidor do zabbix.</p><p><a href="/assets/2013/07/IP_002.png" class="img-link shimmer" ><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 389 285'%3E%3C/svg%3E" class="lazyload wp-image-753 alignnone" alt="IP_002" data-src="/assets/2013/07/IP_002.png" width="389" height="285" data-proofer-ignore></a></p><p>Basta salvar o item que automaticamente o IP do host será capturado na próxima verificação.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/it/'>IT</a>, <a href='/categories/monitoramento/'>Monitoramento</a>, <a href='/categories/zabbix/'>Zabbix</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Resgatando IP válido do agente zabbix - Helvio Junior&url=https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Resgatando IP válido do agente zabbix - Helvio Junior&u=https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Resgatando IP válido do agente zabbix - Helvio Junior&url=https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/security/osint/localizando-ips-que-respondem-para-uma-url/">Localizando IPs que respondem para uma URL</a><li><a href="/security/osint/locating-url-ips-bypass-waf/">Locating IPs that respond to a URL</a><li><a href="/security/edr/instalando-elasticsearch-edr/">Instalando Elasticsearch EDR</a><li><a href="/it/instalando-openvpn-com-autenticacao-em-mysql/">Instalando OpenVPN com autenticação em MySQL</a><li><a href="/it/osce-osed-e-ecxd-certificacoes-de-desenvolvimento-de-exploits/">OSCE, OSED e eCXD: Certificações de desenvolvimento de Exploits</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/it/devel/enviando-alerta-do-zabbix-via-gtalk/"><div class="card-body"> <span class="timeago small" > May 23, 2013 <i class="unloaded">2013-05-23T12:30:02-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enviando alerta do Zabbix via Gtalk</h3><div class="text-muted small"><p> Este post tem o objetivo de demonstrar como criar um script para que o Zabbix possa enviar os alertas via Gtalk. Instalação dos pre-requisitos [sourcecode language="shell"]apt-get install python p...</p></div></div></a></div><div class="card"> <a href="/it/raspberry-pi-autologin-auto-start-uma-aplicacao-e-dessabilitar-screen-blanking/"><div class="card-body"> <span class="timeago small" > May 29, 2013 <i class="unloaded">2013-05-29T16:54:17-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Raspberry Pi, AutoLogin, Auto start uma aplicação e dessabilitar Screen blanking</h3><div class="text-muted small"><p> Este post demonstra como configurar o Raspberry (quando em modo de tela gráfica - x-session) para iniciar automaticamente uma aplicação e prevenir que entre em modo de espera, proteção de tela ou d...</p></div></div></a></div><div class="card"> <a href="/it/instalando-zabbix-3-0-no-ubuntu/"><div class="card-body"> <span class="timeago small" > Jun 21, 2016 <i class="unloaded">2016-06-21T14:51:50-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Instalando Zabbix 3.4 no Ubuntu</h3><div class="text-muted small"><p> Aprenda neste post passo-a-passo como instalar o Zabbix 3.x no ubuntu ou debian. O primeiro passo, em qualquer instalação de servidor ao meu ver, é garantir que todos os pacotes básicos estejam de...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/it/instalando-placa-de-rede-no-ubuntu-no-hyper-v/" class="btn btn-outline-primary" prompt="Older"><p>Instalando placa de rede no ubuntu no Hyper-V</p></a> <a href="/it/devel/carregando-e-utilizando-plug-ins-em-c/" class="btn btn-outline-primary" prompt="Newer"><p>Carregando e utilizando plug-ins em C#</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Resgatando IP válido do agente zabbix'; this.page.url = 'https://www.helviojunior.com.br/it/resgatando-ip-valido-do-agente-zabbix/'; this.page.identifier = '/it/resgatando-ip-valido-do-agente-zabbix/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/helviojunior">Helvio junior (aka M4v3r1ck)</a>. <span data-toggle="tooltip" data-placement="top" title="Some rights reserved.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.helviojunior.com.br{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
