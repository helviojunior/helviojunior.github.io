<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Criando CAPTCHA com C#" /><meta name="author" content="Helvio Junior (m4v3r1ck)" /><meta property="og:locale" content="en_US" /><meta name="description" content="CAPTCHA é um acrônimo da expressão &quot;Completely Automated Public Turing test to tell Computers and Humans Apart&quot; (teste de Turing público completamente automatizado para diferenciação entre computadores e humanos): um teste de desafio cognitivo, utilizado como ferramenta anti-spam evitando que aplicativos automatizados realize post em formulários sem uma interação humana. Um tipo comum de CAPTCHA requer que o usuário identifique as letras de uma imagem distorcida, às vezes com a adição de uma sequência obscurecida das letras ou dos dígitos que apareça na tela. Tendo como base essa descrição retirada do Wikipédia (http://pt.wikipedia.org/wiki/CAPTCHA), irei demonstrar como implementar um CAPTCHA utilizando C#. Este código gera o CAPTCHA conforme os exemplos abaixo O Código que será utilizado foi retirado da internet em buscas pessoais, porém realizei diversos ajustes e melhorias objetivando torná-lo mais completo. A Classe base de todo o processo foi nomeada como CaptchaImage e seu código segue abaixo [sourcecode language=&quot;csharp&quot;] using System; using System.Collections.Generic; using System.Text; using System.Drawing; using System.Drawing.Drawing2D; using System.Drawing.Imaging; using System.Drawing.Text; using System.IO; public class CaptchaImage { // Public properties (all read-only). public string Text { get { return this.text; } } public Bitmap Image { get { return this.image; } } public Byte[] PngImage { get { MemoryStream stream = new MemoryStream(); this.image.Save(stream, ImageFormat.Png); Byte[] data = stream.ToArray(); stream = null; return data; } } public String Base64PngImage { get { return Convert.ToBase64String(PngImage); } } public int Width { get { return this.width; } } public int Height { get { return this.height; } } // Internal properties. private string text; private int width; private int height; private string familyName; private Bitmap image; // For generating random numbers. private Random random = new Random(); // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width and height. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width and height. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height) { this.text = s; this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width, height and font family. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height, String familyName) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width, height and font family. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height, String familyName) { this.text = s; this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // This member overrides Object.Finalize. // ==================================================================== ~CaptchaImage() { Dispose(false); } // ==================================================================== // Releases all resources used by this object. // ==================================================================== public void Dispose() { GC.SuppressFinalize(this); this.Dispose(true); } // ==================================================================== // Custom Dispose method to clean up unmanaged resources. // ==================================================================== protected virtual void Dispose(bool disposing) { if (disposing) // Dispose of the bitmap. this.image.Dispose(); } // ==================================================================== // Generate Random Code of Captcha. // ==================================================================== private void GenerateRandomCode(Int32 length) { List&lt;String&gt; codes = new List&lt;String&gt;(); for (Int32 i = 65; i &lt;= 90; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } /* //Uncomment this for use Numeric text too for (Int32 i = 0; i &lt;= 9; i++) { codes.Add(i.ToString()); }*/ for (Int32 i = 97; i &lt;= 122; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } Random rnd = new Random(); string s = &quot;&quot;; for (int i = 0; i &lt; length; i++) s = String.Concat(s, codes[rnd.Next(0, codes.Count - 1)]); this.text = s; } // ==================================================================== // Sets the image width and height. // ==================================================================== private void SetDimensions(int width, int height) { // Check the width and height. if (width &lt;= 0) throw new ArgumentOutOfRangeException(&quot;width&quot;, width, &quot;Argument out of range, must be greater than zero.&quot;); if (height &lt;= 0) throw new ArgumentOutOfRangeException(&quot;height&quot;, height, &quot;Argument out of range, must be greater than zero.&quot;); this.width = width; this.height = height; } // ==================================================================== // Sets the font used for the image text. // ==================================================================== private void SetFamilyName(string familyName) { // If the named font is not installed, default to a system font. try { Font font = new Font(this.familyName, 12F); this.familyName = familyName; font.Dispose(); } catch (Exception ex) { this.familyName = System.Drawing.FontFamily.GenericSerif.Name; } } // ==================================================================== // Creates the bitmap image. // ==================================================================== private void GenerateImage() { // Create a new 32-bit bitmap image. Bitmap bitmap = new Bitmap(this.width, this.height, PixelFormat.Format32bppArgb); Color backColor = Color.FromArgb((random.Next(100, 255)), (random.Next(100, 255)), (random.Next(100, 255))); Color foreColor = Color.FromArgb(random.Next(0, 100), random.Next(0, 100), random.Next(0, 100)); // Create a graphics object for drawing. Graphics g = Graphics.FromImage(bitmap); g.SmoothingMode = SmoothingMode.AntiAlias; Rectangle rect = new Rectangle(0, 0, this.width, this.height); HatchStyle[] aHatchStyles = new HatchStyle[] { HatchStyle.BackwardDiagonal, HatchStyle.Cross, HatchStyle.DashedDownwardDiagonal, HatchStyle.DashedHorizontal, HatchStyle.DashedUpwardDiagonal, HatchStyle.DashedVertical, HatchStyle.DiagonalBrick, HatchStyle.DiagonalCross, HatchStyle.Divot, HatchStyle.DottedDiamond, HatchStyle.DottedGrid, HatchStyle.ForwardDiagonal, HatchStyle.Horizontal, HatchStyle.HorizontalBrick, HatchStyle.LargeCheckerBoard, HatchStyle.LargeConfetti, HatchStyle.LargeGrid, HatchStyle.LightDownwardDiagonal, HatchStyle.LightHorizontal, HatchStyle.LightUpwardDiagonal, HatchStyle.LightVertical, HatchStyle.Max, HatchStyle.Min, HatchStyle.NarrowHorizontal, HatchStyle.NarrowVertical, HatchStyle.OutlinedDiamond, HatchStyle.Plaid, HatchStyle.Shingle, HatchStyle.SmallCheckerBoard, HatchStyle.SmallConfetti, HatchStyle.SmallGrid, HatchStyle.SolidDiamond, HatchStyle.Sphere, HatchStyle.Trellis, HatchStyle.Vertical, HatchStyle.Wave, HatchStyle.Weave, HatchStyle.WideDownwardDiagonal, HatchStyle.WideUpwardDiagonal, HatchStyle.ZigZag }; // Fill in the background. HatchBrush hatchBrush = new HatchBrush(aHatchStyles[random.Next (aHatchStyles.Length - 1)], backColor, Color.White); g.FillRectangle(hatchBrush, rect); // Set up the text font. SizeF size; float fontSize = rect.Height * 2; Font font; // Adjust the font size until the text fits within the image. do { fontSize -= 0.3F; font = new Font(this.familyName, fontSize, FontStyle.Bold); size = g.MeasureString(this.text, font); } while ((size.Width &gt; rect.Width) || (size.Height &gt; rect.Height)); fontSize = fontSize + (fontSize * 0.20F); font = new Font(this.familyName, fontSize, FontStyle.Bold); // Set up the text format. StringFormat format = new StringFormat(); format.Alignment = StringAlignment.Center; format.LineAlignment = StringAlignment.Center; // Create a path using the text and warp it randomly. GraphicsPath path = new GraphicsPath(); path.AddString(this.text, font.FontFamily, (int)font.Style, font.Size, rect, format); float v = 20F; PointF[] points = { new PointF(this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v) }; Matrix matrix = new Matrix(); matrix.Translate(0F, 0F); path.Warp(points, rect, matrix, WarpMode.Perspective, 0F); // Draw the text. hatchBrush = new HatchBrush(hatchBrush.HatchStyle, foreColor, backColor); g.FillPath(hatchBrush, path); // Add some random noise. int m = Math.Max(rect.Width, rect.Height); for (int i = 0; i &lt; (int)(rect.Width * rect.Height / 30F); i++) { int x = this.random.Next(rect.Width); int y = this.random.Next(rect.Height); int w = this.random.Next(m / 50); int h = this.random.Next(m / 50); g.FillEllipse(hatchBrush, x, y, w, h); } // Draw random lines Int32 linesCount = random.Next(3, 5); Pen lPen = new Pen(new SolidBrush(hatchBrush.ForegroundColor)); for (Int32 l = 1; l &lt;= linesCount; l++) { g.DrawLine(lPen, new Point(random.Next(0, this.width), random.Next(0, this.height)), new Point(random.Next(0, this.width), random.Next(0, this.height)) ); } // Clean up. font.Dispose(); hatchBrush.Dispose(); g.Dispose(); // Set the image. this.image = bitmap; } } [/sourcecode] Para sua utilização há, pelo menos, duas metodologias possíveis, uma página que retornará uma imagem, ou uma tag &lt;img&gt; com o base64 da imagem. Segue o código da página que retorna a imagem [sourcecode language=&quot;csharp&quot;] using System; using System.Collections; using System.Configuration; using System.Data; using System.Text; using System.Web; using System.Web.Security; using System.Web.UI; using System.Web.UI.HtmlControls; using System.Web.UI.WebControls; using System.Web.UI.WebControls.WebParts; using System.IO; using System.Drawing; public partial class EventImage : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { try { //Set Response code this.Response.StatusCode = 200; this.Response.Status = &quot;200 OK&quot;; //Add last modified date this.Response.AddHeader(&quot;Last-Modified&quot;, DateTime.Now.ToString(&quot;r&quot;, System.Globalization.CultureInfo.CreateSpecificCulture(&quot;en-US&quot;))); //Change content type this.Response.ContentType = &quot;image/png&quot;; //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); //Get Byte array of image in PNG Byte[] imgData = cap.PngImage; //Set the byte array of the image in output stream this.Response.OutputStream.Write(imgData, 0, imgData.Length); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; } catch (Exception ex) { //Set error response code this.Response.Status = &quot;505 Internal error&quot;; this.Response.StatusCode = 505; } } } [/sourcecode] Segue o código para retorno do base64 da imagem [sourcecode language=&quot;csharp&quot;] //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); Holder1.Controls.Add(new LiteralControl(&quot;&lt;img border=\&quot;0\&quot; style=\&quot;width: 200px; height: 50px; background: url(&#39;data:image/png;base64,&quot; + cap.Base64PngImage + &quot;&#39;) no-repeat scroll 0px 0px transparent;\&quot; src=\&quot;/images/empty.gif\&quot; title=\&quot;Imagem de confirmação\&quot;&gt;&quot;)); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; [/sourcecode] Note que em ambos as metodologias acima, foi gravado em uma sessão o texto do captcha, desta fora a validação pode ser realizada com esta sessão conforme exemplo abaixo [sourcecode language=&quot;csharp&quot;] String captchaText = Request.Form[&quot;captcha&quot;]; String sCaptchaText = (String)Session[&quot;captchaText&quot;]; if (sCaptchaText == null) sCaptchaText = &quot;&quot;; if (captchaText.ToLower() = sCaptchaText.ToLower()) { //OK } [/sourcecode]" /><meta property="og:description" content="CAPTCHA é um acrônimo da expressão &quot;Completely Automated Public Turing test to tell Computers and Humans Apart&quot; (teste de Turing público completamente automatizado para diferenciação entre computadores e humanos): um teste de desafio cognitivo, utilizado como ferramenta anti-spam evitando que aplicativos automatizados realize post em formulários sem uma interação humana. Um tipo comum de CAPTCHA requer que o usuário identifique as letras de uma imagem distorcida, às vezes com a adição de uma sequência obscurecida das letras ou dos dígitos que apareça na tela. Tendo como base essa descrição retirada do Wikipédia (http://pt.wikipedia.org/wiki/CAPTCHA), irei demonstrar como implementar um CAPTCHA utilizando C#. Este código gera o CAPTCHA conforme os exemplos abaixo O Código que será utilizado foi retirado da internet em buscas pessoais, porém realizei diversos ajustes e melhorias objetivando torná-lo mais completo. A Classe base de todo o processo foi nomeada como CaptchaImage e seu código segue abaixo [sourcecode language=&quot;csharp&quot;] using System; using System.Collections.Generic; using System.Text; using System.Drawing; using System.Drawing.Drawing2D; using System.Drawing.Imaging; using System.Drawing.Text; using System.IO; public class CaptchaImage { // Public properties (all read-only). public string Text { get { return this.text; } } public Bitmap Image { get { return this.image; } } public Byte[] PngImage { get { MemoryStream stream = new MemoryStream(); this.image.Save(stream, ImageFormat.Png); Byte[] data = stream.ToArray(); stream = null; return data; } } public String Base64PngImage { get { return Convert.ToBase64String(PngImage); } } public int Width { get { return this.width; } } public int Height { get { return this.height; } } // Internal properties. private string text; private int width; private int height; private string familyName; private Bitmap image; // For generating random numbers. private Random random = new Random(); // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width and height. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width and height. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height) { this.text = s; this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width, height and font family. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height, String familyName) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width, height and font family. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height, String familyName) { this.text = s; this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // This member overrides Object.Finalize. // ==================================================================== ~CaptchaImage() { Dispose(false); } // ==================================================================== // Releases all resources used by this object. // ==================================================================== public void Dispose() { GC.SuppressFinalize(this); this.Dispose(true); } // ==================================================================== // Custom Dispose method to clean up unmanaged resources. // ==================================================================== protected virtual void Dispose(bool disposing) { if (disposing) // Dispose of the bitmap. this.image.Dispose(); } // ==================================================================== // Generate Random Code of Captcha. // ==================================================================== private void GenerateRandomCode(Int32 length) { List&lt;String&gt; codes = new List&lt;String&gt;(); for (Int32 i = 65; i &lt;= 90; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } /* //Uncomment this for use Numeric text too for (Int32 i = 0; i &lt;= 9; i++) { codes.Add(i.ToString()); }*/ for (Int32 i = 97; i &lt;= 122; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } Random rnd = new Random(); string s = &quot;&quot;; for (int i = 0; i &lt; length; i++) s = String.Concat(s, codes[rnd.Next(0, codes.Count - 1)]); this.text = s; } // ==================================================================== // Sets the image width and height. // ==================================================================== private void SetDimensions(int width, int height) { // Check the width and height. if (width &lt;= 0) throw new ArgumentOutOfRangeException(&quot;width&quot;, width, &quot;Argument out of range, must be greater than zero.&quot;); if (height &lt;= 0) throw new ArgumentOutOfRangeException(&quot;height&quot;, height, &quot;Argument out of range, must be greater than zero.&quot;); this.width = width; this.height = height; } // ==================================================================== // Sets the font used for the image text. // ==================================================================== private void SetFamilyName(string familyName) { // If the named font is not installed, default to a system font. try { Font font = new Font(this.familyName, 12F); this.familyName = familyName; font.Dispose(); } catch (Exception ex) { this.familyName = System.Drawing.FontFamily.GenericSerif.Name; } } // ==================================================================== // Creates the bitmap image. // ==================================================================== private void GenerateImage() { // Create a new 32-bit bitmap image. Bitmap bitmap = new Bitmap(this.width, this.height, PixelFormat.Format32bppArgb); Color backColor = Color.FromArgb((random.Next(100, 255)), (random.Next(100, 255)), (random.Next(100, 255))); Color foreColor = Color.FromArgb(random.Next(0, 100), random.Next(0, 100), random.Next(0, 100)); // Create a graphics object for drawing. Graphics g = Graphics.FromImage(bitmap); g.SmoothingMode = SmoothingMode.AntiAlias; Rectangle rect = new Rectangle(0, 0, this.width, this.height); HatchStyle[] aHatchStyles = new HatchStyle[] { HatchStyle.BackwardDiagonal, HatchStyle.Cross, HatchStyle.DashedDownwardDiagonal, HatchStyle.DashedHorizontal, HatchStyle.DashedUpwardDiagonal, HatchStyle.DashedVertical, HatchStyle.DiagonalBrick, HatchStyle.DiagonalCross, HatchStyle.Divot, HatchStyle.DottedDiamond, HatchStyle.DottedGrid, HatchStyle.ForwardDiagonal, HatchStyle.Horizontal, HatchStyle.HorizontalBrick, HatchStyle.LargeCheckerBoard, HatchStyle.LargeConfetti, HatchStyle.LargeGrid, HatchStyle.LightDownwardDiagonal, HatchStyle.LightHorizontal, HatchStyle.LightUpwardDiagonal, HatchStyle.LightVertical, HatchStyle.Max, HatchStyle.Min, HatchStyle.NarrowHorizontal, HatchStyle.NarrowVertical, HatchStyle.OutlinedDiamond, HatchStyle.Plaid, HatchStyle.Shingle, HatchStyle.SmallCheckerBoard, HatchStyle.SmallConfetti, HatchStyle.SmallGrid, HatchStyle.SolidDiamond, HatchStyle.Sphere, HatchStyle.Trellis, HatchStyle.Vertical, HatchStyle.Wave, HatchStyle.Weave, HatchStyle.WideDownwardDiagonal, HatchStyle.WideUpwardDiagonal, HatchStyle.ZigZag }; // Fill in the background. HatchBrush hatchBrush = new HatchBrush(aHatchStyles[random.Next (aHatchStyles.Length - 1)], backColor, Color.White); g.FillRectangle(hatchBrush, rect); // Set up the text font. SizeF size; float fontSize = rect.Height * 2; Font font; // Adjust the font size until the text fits within the image. do { fontSize -= 0.3F; font = new Font(this.familyName, fontSize, FontStyle.Bold); size = g.MeasureString(this.text, font); } while ((size.Width &gt; rect.Width) || (size.Height &gt; rect.Height)); fontSize = fontSize + (fontSize * 0.20F); font = new Font(this.familyName, fontSize, FontStyle.Bold); // Set up the text format. StringFormat format = new StringFormat(); format.Alignment = StringAlignment.Center; format.LineAlignment = StringAlignment.Center; // Create a path using the text and warp it randomly. GraphicsPath path = new GraphicsPath(); path.AddString(this.text, font.FontFamily, (int)font.Style, font.Size, rect, format); float v = 20F; PointF[] points = { new PointF(this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v) }; Matrix matrix = new Matrix(); matrix.Translate(0F, 0F); path.Warp(points, rect, matrix, WarpMode.Perspective, 0F); // Draw the text. hatchBrush = new HatchBrush(hatchBrush.HatchStyle, foreColor, backColor); g.FillPath(hatchBrush, path); // Add some random noise. int m = Math.Max(rect.Width, rect.Height); for (int i = 0; i &lt; (int)(rect.Width * rect.Height / 30F); i++) { int x = this.random.Next(rect.Width); int y = this.random.Next(rect.Height); int w = this.random.Next(m / 50); int h = this.random.Next(m / 50); g.FillEllipse(hatchBrush, x, y, w, h); } // Draw random lines Int32 linesCount = random.Next(3, 5); Pen lPen = new Pen(new SolidBrush(hatchBrush.ForegroundColor)); for (Int32 l = 1; l &lt;= linesCount; l++) { g.DrawLine(lPen, new Point(random.Next(0, this.width), random.Next(0, this.height)), new Point(random.Next(0, this.width), random.Next(0, this.height)) ); } // Clean up. font.Dispose(); hatchBrush.Dispose(); g.Dispose(); // Set the image. this.image = bitmap; } } [/sourcecode] Para sua utilização há, pelo menos, duas metodologias possíveis, uma página que retornará uma imagem, ou uma tag &lt;img&gt; com o base64 da imagem. Segue o código da página que retorna a imagem [sourcecode language=&quot;csharp&quot;] using System; using System.Collections; using System.Configuration; using System.Data; using System.Text; using System.Web; using System.Web.Security; using System.Web.UI; using System.Web.UI.HtmlControls; using System.Web.UI.WebControls; using System.Web.UI.WebControls.WebParts; using System.IO; using System.Drawing; public partial class EventImage : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { try { //Set Response code this.Response.StatusCode = 200; this.Response.Status = &quot;200 OK&quot;; //Add last modified date this.Response.AddHeader(&quot;Last-Modified&quot;, DateTime.Now.ToString(&quot;r&quot;, System.Globalization.CultureInfo.CreateSpecificCulture(&quot;en-US&quot;))); //Change content type this.Response.ContentType = &quot;image/png&quot;; //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); //Get Byte array of image in PNG Byte[] imgData = cap.PngImage; //Set the byte array of the image in output stream this.Response.OutputStream.Write(imgData, 0, imgData.Length); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; } catch (Exception ex) { //Set error response code this.Response.Status = &quot;505 Internal error&quot;; this.Response.StatusCode = 505; } } } [/sourcecode] Segue o código para retorno do base64 da imagem [sourcecode language=&quot;csharp&quot;] //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); Holder1.Controls.Add(new LiteralControl(&quot;&lt;img border=\&quot;0\&quot; style=\&quot;width: 200px; height: 50px; background: url(&#39;data:image/png;base64,&quot; + cap.Base64PngImage + &quot;&#39;) no-repeat scroll 0px 0px transparent;\&quot; src=\&quot;/images/empty.gif\&quot; title=\&quot;Imagem de confirmação\&quot;&gt;&quot;)); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; [/sourcecode] Note que em ambos as metodologias acima, foi gravado em uma sessão o texto do captcha, desta fora a validação pode ser realizada com esta sessão conforme exemplo abaixo [sourcecode language=&quot;csharp&quot;] String captchaText = Request.Form[&quot;captcha&quot;]; String sCaptchaText = (String)Session[&quot;captchaText&quot;]; if (sCaptchaText == null) sCaptchaText = &quot;&quot;; if (captchaText.ToLower() = sCaptchaText.ToLower()) { //OK } [/sourcecode]" /><link rel="canonical" href="https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" /><meta property="og:url" content="https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" /><meta property="og:site_name" content="Helvio Junior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2012-04-18T16:33:02-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Criando CAPTCHA com C#" /><meta name="twitter:site" content="@helvioju" /><meta name="twitter:creator" content="@Helvio Junior (m4v3r1ck)" /><meta name="google-site-verification" content="JR4IIP9jfvOwxn2ybV_Qn0SrtDPlTrKomdPWgBuP55k"" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Helvio Junior (m4v3r1ck)"},"dateModified":"2023-08-17T00:19:29-03:00","datePublished":"2012-04-18T16:33:02-03:00","description":"CAPTCHA é um acrônimo da expressão &quot;Completely Automated Public Turing test to tell Computers and Humans Apart&quot; (teste de Turing público completamente automatizado para diferenciação entre computadores e humanos): um teste de desafio cognitivo, utilizado como ferramenta anti-spam evitando que aplicativos automatizados realize post em formulários sem uma interação humana. Um tipo comum de CAPTCHA requer que o usuário identifique as letras de uma imagem distorcida, às vezes com a adição de uma sequência obscurecida das letras ou dos dígitos que apareça na tela. Tendo como base essa descrição retirada do Wikipédia (http://pt.wikipedia.org/wiki/CAPTCHA), irei demonstrar como implementar um CAPTCHA utilizando C#. Este código gera o CAPTCHA conforme os exemplos abaixo O Código que será utilizado foi retirado da internet em buscas pessoais, porém realizei diversos ajustes e melhorias objetivando torná-lo mais completo. A Classe base de todo o processo foi nomeada como CaptchaImage e seu código segue abaixo [sourcecode language=&quot;csharp&quot;] using System; using System.Collections.Generic; using System.Text; using System.Drawing; using System.Drawing.Drawing2D; using System.Drawing.Imaging; using System.Drawing.Text; using System.IO; public class CaptchaImage { // Public properties (all read-only). public string Text { get { return this.text; } } public Bitmap Image { get { return this.image; } } public Byte[] PngImage { get { MemoryStream stream = new MemoryStream(); this.image.Save(stream, ImageFormat.Png); Byte[] data = stream.ToArray(); stream = null; return data; } } public String Base64PngImage { get { return Convert.ToBase64String(PngImage); } } public int Width { get { return this.width; } } public int Height { get { return this.height; } } // Internal properties. private string text; private int width; private int height; private string familyName; private Bitmap image; // For generating random numbers. private Random random = new Random(); // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width and height. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width and height. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height) { this.text = s; this.SetDimensions(width, height); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified width, height and font family. // ==================================================================== public CaptchaImage(Int32 length, Int32 width, Int32 height, String familyName) { this.GenerateRandomCode(length); this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // Initializes a new instance of the CaptchaImage class using the // specified text, width, height and font family. // ==================================================================== public CaptchaImage(String s, Int32 width, Int32 height, String familyName) { this.text = s; this.SetDimensions(width, height); this.SetFamilyName(familyName); this.GenerateImage(); } // ==================================================================== // This member overrides Object.Finalize. // ==================================================================== ~CaptchaImage() { Dispose(false); } // ==================================================================== // Releases all resources used by this object. // ==================================================================== public void Dispose() { GC.SuppressFinalize(this); this.Dispose(true); } // ==================================================================== // Custom Dispose method to clean up unmanaged resources. // ==================================================================== protected virtual void Dispose(bool disposing) { if (disposing) // Dispose of the bitmap. this.image.Dispose(); } // ==================================================================== // Generate Random Code of Captcha. // ==================================================================== private void GenerateRandomCode(Int32 length) { List&lt;String&gt; codes = new List&lt;String&gt;(); for (Int32 i = 65; i &lt;= 90; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } /* //Uncomment this for use Numeric text too for (Int32 i = 0; i &lt;= 9; i++) { codes.Add(i.ToString()); }*/ for (Int32 i = 97; i &lt;= 122; i++) { codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) })); } Random rnd = new Random(); string s = &quot;&quot;; for (int i = 0; i &lt; length; i++) s = String.Concat(s, codes[rnd.Next(0, codes.Count - 1)]); this.text = s; } // ==================================================================== // Sets the image width and height. // ==================================================================== private void SetDimensions(int width, int height) { // Check the width and height. if (width &lt;= 0) throw new ArgumentOutOfRangeException(&quot;width&quot;, width, &quot;Argument out of range, must be greater than zero.&quot;); if (height &lt;= 0) throw new ArgumentOutOfRangeException(&quot;height&quot;, height, &quot;Argument out of range, must be greater than zero.&quot;); this.width = width; this.height = height; } // ==================================================================== // Sets the font used for the image text. // ==================================================================== private void SetFamilyName(string familyName) { // If the named font is not installed, default to a system font. try { Font font = new Font(this.familyName, 12F); this.familyName = familyName; font.Dispose(); } catch (Exception ex) { this.familyName = System.Drawing.FontFamily.GenericSerif.Name; } } // ==================================================================== // Creates the bitmap image. // ==================================================================== private void GenerateImage() { // Create a new 32-bit bitmap image. Bitmap bitmap = new Bitmap(this.width, this.height, PixelFormat.Format32bppArgb); Color backColor = Color.FromArgb((random.Next(100, 255)), (random.Next(100, 255)), (random.Next(100, 255))); Color foreColor = Color.FromArgb(random.Next(0, 100), random.Next(0, 100), random.Next(0, 100)); // Create a graphics object for drawing. Graphics g = Graphics.FromImage(bitmap); g.SmoothingMode = SmoothingMode.AntiAlias; Rectangle rect = new Rectangle(0, 0, this.width, this.height); HatchStyle[] aHatchStyles = new HatchStyle[] { HatchStyle.BackwardDiagonal, HatchStyle.Cross, HatchStyle.DashedDownwardDiagonal, HatchStyle.DashedHorizontal, HatchStyle.DashedUpwardDiagonal, HatchStyle.DashedVertical, HatchStyle.DiagonalBrick, HatchStyle.DiagonalCross, HatchStyle.Divot, HatchStyle.DottedDiamond, HatchStyle.DottedGrid, HatchStyle.ForwardDiagonal, HatchStyle.Horizontal, HatchStyle.HorizontalBrick, HatchStyle.LargeCheckerBoard, HatchStyle.LargeConfetti, HatchStyle.LargeGrid, HatchStyle.LightDownwardDiagonal, HatchStyle.LightHorizontal, HatchStyle.LightUpwardDiagonal, HatchStyle.LightVertical, HatchStyle.Max, HatchStyle.Min, HatchStyle.NarrowHorizontal, HatchStyle.NarrowVertical, HatchStyle.OutlinedDiamond, HatchStyle.Plaid, HatchStyle.Shingle, HatchStyle.SmallCheckerBoard, HatchStyle.SmallConfetti, HatchStyle.SmallGrid, HatchStyle.SolidDiamond, HatchStyle.Sphere, HatchStyle.Trellis, HatchStyle.Vertical, HatchStyle.Wave, HatchStyle.Weave, HatchStyle.WideDownwardDiagonal, HatchStyle.WideUpwardDiagonal, HatchStyle.ZigZag }; // Fill in the background. HatchBrush hatchBrush = new HatchBrush(aHatchStyles[random.Next (aHatchStyles.Length - 1)], backColor, Color.White); g.FillRectangle(hatchBrush, rect); // Set up the text font. SizeF size; float fontSize = rect.Height * 2; Font font; // Adjust the font size until the text fits within the image. do { fontSize -= 0.3F; font = new Font(this.familyName, fontSize, FontStyle.Bold); size = g.MeasureString(this.text, font); } while ((size.Width &gt; rect.Width) || (size.Height &gt; rect.Height)); fontSize = fontSize + (fontSize * 0.20F); font = new Font(this.familyName, fontSize, FontStyle.Bold); // Set up the text format. StringFormat format = new StringFormat(); format.Alignment = StringAlignment.Center; format.LineAlignment = StringAlignment.Center; // Create a path using the text and warp it randomly. GraphicsPath path = new GraphicsPath(); path.AddString(this.text, font.FontFamily, (int)font.Style, font.Size, rect, format); float v = 20F; PointF[] points = { new PointF(this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v), new PointF(this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v), new PointF(rect.Width - this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v) }; Matrix matrix = new Matrix(); matrix.Translate(0F, 0F); path.Warp(points, rect, matrix, WarpMode.Perspective, 0F); // Draw the text. hatchBrush = new HatchBrush(hatchBrush.HatchStyle, foreColor, backColor); g.FillPath(hatchBrush, path); // Add some random noise. int m = Math.Max(rect.Width, rect.Height); for (int i = 0; i &lt; (int)(rect.Width * rect.Height / 30F); i++) { int x = this.random.Next(rect.Width); int y = this.random.Next(rect.Height); int w = this.random.Next(m / 50); int h = this.random.Next(m / 50); g.FillEllipse(hatchBrush, x, y, w, h); } // Draw random lines Int32 linesCount = random.Next(3, 5); Pen lPen = new Pen(new SolidBrush(hatchBrush.ForegroundColor)); for (Int32 l = 1; l &lt;= linesCount; l++) { g.DrawLine(lPen, new Point(random.Next(0, this.width), random.Next(0, this.height)), new Point(random.Next(0, this.width), random.Next(0, this.height)) ); } // Clean up. font.Dispose(); hatchBrush.Dispose(); g.Dispose(); // Set the image. this.image = bitmap; } } [/sourcecode] Para sua utilização há, pelo menos, duas metodologias possíveis, uma página que retornará uma imagem, ou uma tag &lt;img&gt; com o base64 da imagem. Segue o código da página que retorna a imagem [sourcecode language=&quot;csharp&quot;] using System; using System.Collections; using System.Configuration; using System.Data; using System.Text; using System.Web; using System.Web.Security; using System.Web.UI; using System.Web.UI.HtmlControls; using System.Web.UI.WebControls; using System.Web.UI.WebControls.WebParts; using System.IO; using System.Drawing; public partial class EventImage : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { try { //Set Response code this.Response.StatusCode = 200; this.Response.Status = &quot;200 OK&quot;; //Add last modified date this.Response.AddHeader(&quot;Last-Modified&quot;, DateTime.Now.ToString(&quot;r&quot;, System.Globalization.CultureInfo.CreateSpecificCulture(&quot;en-US&quot;))); //Change content type this.Response.ContentType = &quot;image/png&quot;; //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); //Get Byte array of image in PNG Byte[] imgData = cap.PngImage; //Set the byte array of the image in output stream this.Response.OutputStream.Write(imgData, 0, imgData.Length); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; } catch (Exception ex) { //Set error response code this.Response.Status = &quot;505 Internal error&quot;; this.Response.StatusCode = 505; } } } [/sourcecode] Segue o código para retorno do base64 da imagem [sourcecode language=&quot;csharp&quot;] //Create the captcha bitmap CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;); Holder1.Controls.Add(new LiteralControl(&quot;&lt;img border=\\&quot;0\\&quot; style=\\&quot;width: 200px; height: 50px; background: url(&#39;data:image/png;base64,&quot; + cap.Base64PngImage + &quot;&#39;) no-repeat scroll 0px 0px transparent;\\&quot; src=\\&quot;/images/empty.gif\\&quot; title=\\&quot;Imagem de confirmação\\&quot;&gt;&quot;)); //Set the session of the text for the captcha validation Session[&quot;captchaText&quot;] = cap.Text; [/sourcecode] Note que em ambos as metodologias acima, foi gravado em uma sessão o texto do captcha, desta fora a validação pode ser realizada com esta sessão conforme exemplo abaixo [sourcecode language=&quot;csharp&quot;] String captchaText = Request.Form[&quot;captcha&quot;]; String sCaptchaText = (String)Session[&quot;captchaText&quot;]; if (sCaptchaText == null) sCaptchaText = &quot;&quot;; if (captchaText.ToLower() = sCaptchaText.ToLower()) { //OK } [/sourcecode]","headline":"Criando CAPTCHA com C#","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/"},"url":"https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/"}</script><title>Criando CAPTCHA com C# | Helvio Junior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Helvio Junior"><meta name="application-name" content="Helvio Junior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/m4v3r1ck.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Helvio Junior</a></div><div class="site-subtitle font-italic">Cyber security researcher, speaker, low level and binary exploitation entusiast. <br /><br />"I’m just a child who has never grown up. I still keep asking these 'how' & 'why' questions. Occasionally, I find an answer. Stephen Hawking"</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://www.linkedin.com/in/helviojunior" aria-label="linkedin" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/@Sec4US" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/helviojunior" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['helvio.junior','sec4us.com.br'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/it"> It </a> </span> <span> <a href="/devel"> Devel </a> </span> <span>Criando CAPTCHA com C#</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Criando CAPTCHA com C#</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Helvio Junior (m4v3r1ck) </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Apr 18, 2012, 4:33 PM -0300" prep="on" > Apr 18, 2012 <i class="unloaded">2012-04-18T16:33:02-03:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 17, 2023, 12:19 AM -0300" prefix="Updated " > Aug 17, 2023 <i class="unloaded">2023-08-17T00:19:29-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1398 words">7 min</span></div></div><div class="post-content"><p>CAPTCHA é um acrônimo da expressão "Completely Automated Public Turing test to tell Computers and Humans Apart" (teste de Turing público completamente automatizado para diferenciação entre computadores e humanos): um teste de desafio cognitivo, utilizado como ferramenta anti-spam evitando que aplicativos automatizados realize post em formulários sem uma interação humana.</p><p>Um tipo comum de CAPTCHA requer que o usuário identifique as letras de uma imagem distorcida, às vezes com a adição de uma sequência obscurecida das letras ou dos dígitos que apareça na tela.</p><p>Tendo como base essa descrição retirada do Wikipédia (http://pt.wikipedia.org/wiki/CAPTCHA), irei demonstrar como implementar um CAPTCHA utilizando C#.</p><p>Este código gera o CAPTCHA conforme os exemplos abaixo</p><p><a href="/assets/2012/04/captcha_samples.jpg" class="img-link shimmer" ><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 446 177'%3E%3C/svg%3E" title="Captcha Samples" data-src="/assets/2012/04/captcha_samples.jpg" alt="" width="446" height="177" class="lazyload" data-proofer-ignore></a></p><p><br /> O Código que será utilizado foi retirado da internet em buscas pessoais, porém realizei diversos ajustes e melhorias objetivando torná-lo mais completo.</p><p>A Classe base de todo o processo foi nomeada como CaptchaImage e seu código segue abaixo</p><p>[sourcecode language="csharp"]<br /> using System;<br /> using System.Collections.Generic;<br /> using System.Text;<br /> using System.Drawing;<br /> using System.Drawing.Drawing2D;<br /> using System.Drawing.Imaging;<br /> using System.Drawing.Text;<br /> using System.IO;</p><p>public class CaptchaImage<br /> {<br /> // Public properties (all read-only).<br /> public string Text<br /> {<br /> get { return this.text; }<br /> }</p><p> public Bitmap Image<br /> {<br /> get { return this.image; }<br /> }</p><p> public Byte[] PngImage<br /> {<br /> get<br /> {<br /> MemoryStream stream = new MemoryStream();<br /> this.image.Save(stream, ImageFormat.Png);</p><p> Byte[] data = stream.ToArray();<br /> stream = null;</p><p> return data;<br /> }<br /> }</p><p> public String Base64PngImage<br /> {<br /> get<br /> {<br /> return Convert.ToBase64String(PngImage);<br /> }<br /> }</p><p> public int Width<br /> {<br /> get { return this.width; }<br /> }</p><p> public int Height<br /> {<br /> get { return this.height; }<br /> }</p><p> // Internal properties.<br /> private string text;<br /> private int width;<br /> private int height;<br /> private string familyName;<br /> private Bitmap image;</p><p> // For generating random numbers.<br /> private Random random = new Random();</p><p> // ====================================================================<br /> // Initializes a new instance of the CaptchaImage class using the<br /> // specified width and height.<br /> // ====================================================================<br /> public CaptchaImage(Int32 length, Int32 width, Int32 height)<br /> {<br /> this.GenerateRandomCode(length);<br /> this.SetDimensions(width, height);<br /> this.GenerateImage();<br /> }</p><p> // ====================================================================<br /> // Initializes a new instance of the CaptchaImage class using the<br /> // specified text, width and height.<br /> // ====================================================================<br /> public CaptchaImage(String s, Int32 width, Int32 height)<br /> {<br /> this.text = s;<br /> this.SetDimensions(width, height);<br /> this.GenerateImage();<br /> }</p><p> // ====================================================================<br /> // Initializes a new instance of the CaptchaImage class using the<br /> // specified width, height and font family.<br /> // ====================================================================<br /> public CaptchaImage(Int32 length, Int32 width, Int32 height, String familyName)<br /> {<br /> this.GenerateRandomCode(length);<br /> this.SetDimensions(width, height);<br /> this.SetFamilyName(familyName);<br /> this.GenerateImage();<br /> }</p><p> // ====================================================================<br /> // Initializes a new instance of the CaptchaImage class using the<br /> // specified text, width, height and font family.<br /> // ====================================================================<br /> public CaptchaImage(String s, Int32 width, Int32 height, String familyName)<br /> {<br /> this.text = s;<br /> this.SetDimensions(width, height);<br /> this.SetFamilyName(familyName);<br /> this.GenerateImage();<br /> }</p><p> // ====================================================================<br /> // This member overrides Object.Finalize.<br /> // ====================================================================<br /> ~CaptchaImage()<br /> {<br /> Dispose(false);<br /> }</p><p> // ====================================================================<br /> // Releases all resources used by this object.<br /> // ====================================================================<br /> public void Dispose()<br /> {<br /> GC.SuppressFinalize(this);<br /> this.Dispose(true);<br /> }</p><p> // ====================================================================<br /> // Custom Dispose method to clean up unmanaged resources.<br /> // ====================================================================<br /> protected virtual void Dispose(bool disposing)<br /> {<br /> if (disposing)<br /> // Dispose of the bitmap.<br /> this.image.Dispose();<br /> }</p><p> // ====================================================================<br /> // Generate Random Code of Captcha.<br /> // ====================================================================<br /> private void GenerateRandomCode(Int32 length)<br /> {<br /> List&lt;String&gt; codes = new List&lt;String&gt;();</p><p> for (Int32 i = 65; i &lt;= 90; i++)<br /> {<br /> codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) }));<br /> }</p><p> /*<br /> //Uncomment this for use Numeric text too<br /> for (Int32 i = 0; i &lt;= 9; i++)<br /> {<br /> codes.Add(i.ToString());<br /> }*/</p><p> for (Int32 i = 97; i &lt;= 122; i++)<br /> {<br /> codes.Add(Encoding.ASCII.GetString(new Byte[] { Byte.Parse(i.ToString(&quot;X&quot;), System.Globalization.NumberStyles.HexNumber) }));<br /> }</p><p> Random rnd = new Random();<br /> string s = &quot;&quot;;<br /> for (int i = 0; i &lt; length; i++)<br /> s = String.Concat(s, codes[rnd.Next(0, codes.Count - 1)]);</p><p> this.text = s;<br /> }</p><p> // ====================================================================<br /> // Sets the image width and height.<br /> // ====================================================================<br /> private void SetDimensions(int width, int height)<br /> {<br /> // Check the width and height.<br /> if (width &lt;= 0)<br /> throw new ArgumentOutOfRangeException(&quot;width&quot;, width, &quot;Argument out of range, must be greater than zero.&quot;);<br /> if (height &lt;= 0)<br /> throw new ArgumentOutOfRangeException(&quot;height&quot;, height, &quot;Argument out of range, must be greater than zero.&quot;);<br /> this.width = width;<br /> this.height = height;<br /> }</p><p> // ====================================================================<br /> // Sets the font used for the image text.<br /> // ====================================================================<br /> private void SetFamilyName(string familyName)<br /> {<br /> // If the named font is not installed, default to a system font.<br /> try<br /> {<br /> Font font = new Font(this.familyName, 12F);<br /> this.familyName = familyName;<br /> font.Dispose();<br /> }<br /> catch (Exception ex)<br /> {<br /> this.familyName = System.Drawing.FontFamily.GenericSerif.Name;<br /> }<br /> }</p><p> // ====================================================================<br /> // Creates the bitmap image.<br /> // ====================================================================<br /> private void GenerateImage()<br /> {<br /> // Create a new 32-bit bitmap image.<br /> Bitmap bitmap = new Bitmap(this.width, this.height, PixelFormat.Format32bppArgb);</p><p> Color backColor = Color.FromArgb((random.Next(100, 255)),<br /> (random.Next(100, 255)), (random.Next(100, 255)));</p><p> Color foreColor = Color.FromArgb(random.Next(0, 100),<br /> random.Next(0, 100), random.Next(0, 100));</p><p> // Create a graphics object for drawing.<br /> Graphics g = Graphics.FromImage(bitmap);<br /> g.SmoothingMode = SmoothingMode.AntiAlias;<br /> Rectangle rect = new Rectangle(0, 0, this.width, this.height);</p><p> HatchStyle[] aHatchStyles = new HatchStyle[]<br /> {<br /> HatchStyle.BackwardDiagonal, HatchStyle.Cross,<br /> HatchStyle.DashedDownwardDiagonal, HatchStyle.DashedHorizontal,<br /> HatchStyle.DashedUpwardDiagonal, HatchStyle.DashedVertical,<br /> HatchStyle.DiagonalBrick, HatchStyle.DiagonalCross,<br /> HatchStyle.Divot, HatchStyle.DottedDiamond, HatchStyle.DottedGrid,<br /> HatchStyle.ForwardDiagonal, HatchStyle.Horizontal,<br /> HatchStyle.HorizontalBrick, HatchStyle.LargeCheckerBoard,<br /> HatchStyle.LargeConfetti, HatchStyle.LargeGrid,<br /> HatchStyle.LightDownwardDiagonal, HatchStyle.LightHorizontal,<br /> HatchStyle.LightUpwardDiagonal, HatchStyle.LightVertical,<br /> HatchStyle.Max, HatchStyle.Min, HatchStyle.NarrowHorizontal,<br /> HatchStyle.NarrowVertical, HatchStyle.OutlinedDiamond,<br /> HatchStyle.Plaid, HatchStyle.Shingle, HatchStyle.SmallCheckerBoard,<br /> HatchStyle.SmallConfetti, HatchStyle.SmallGrid,<br /> HatchStyle.SolidDiamond, HatchStyle.Sphere, HatchStyle.Trellis,<br /> HatchStyle.Vertical, HatchStyle.Wave, HatchStyle.Weave,<br /> HatchStyle.WideDownwardDiagonal, HatchStyle.WideUpwardDiagonal, HatchStyle.ZigZag<br /> };</p><p> // Fill in the background.<br /> HatchBrush hatchBrush = new HatchBrush(aHatchStyles[random.Next<br /> (aHatchStyles.Length - 1)], backColor, Color.White);<br /> g.FillRectangle(hatchBrush, rect);</p><p> // Set up the text font.<br /> SizeF size;<br /> float fontSize = rect.Height * 2;<br /> Font font;</p><p> // Adjust the font size until the text fits within the image.<br /> do<br /> {<br /> fontSize -= 0.3F;<br /> font = new Font(this.familyName, fontSize, FontStyle.Bold);<br /> size = g.MeasureString(this.text, font);<br /> } while ((size.Width &gt; rect.Width) || (size.Height &gt; rect.Height));</p><p> fontSize = fontSize + (fontSize * 0.20F);<br /> font = new Font(this.familyName, fontSize, FontStyle.Bold);</p><p> // Set up the text format.<br /> StringFormat format = new StringFormat();<br /> format.Alignment = StringAlignment.Center;<br /> format.LineAlignment = StringAlignment.Center;</p><p> // Create a path using the text and warp it randomly.<br /> GraphicsPath path = new GraphicsPath();<br /> path.AddString(this.text, font.FontFamily, (int)font.Style, font.Size, rect, format);</p><p> float v = 20F;<br /> PointF[] points =<br /> {<br /> new PointF(this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v),<br /> new PointF(rect.Width - this.random.Next(rect.Width) / v, this.random.Next(rect.Height) / v),<br /> new PointF(this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v),<br /> new PointF(rect.Width - this.random.Next(rect.Width) / v, rect.Height - this.random.Next(rect.Height) / v)<br /> };</p><p> Matrix matrix = new Matrix();<br /> matrix.Translate(0F, 0F);<br /> path.Warp(points, rect, matrix, WarpMode.Perspective, 0F);</p><p> // Draw the text.<br /> hatchBrush = new HatchBrush(hatchBrush.HatchStyle, foreColor, backColor);<br /> g.FillPath(hatchBrush, path);</p><p> // Add some random noise.</p><p> int m = Math.Max(rect.Width, rect.Height);<br /> for (int i = 0; i &lt; (int)(rect.Width * rect.Height / 30F); i++)<br /> {<br /> int x = this.random.Next(rect.Width);<br /> int y = this.random.Next(rect.Height);<br /> int w = this.random.Next(m / 50);<br /> int h = this.random.Next(m / 50);<br /> g.FillEllipse(hatchBrush, x, y, w, h);<br /> }</p><p> // Draw random lines<br /> Int32 linesCount = random.Next(3, 5);<br /> Pen lPen = new Pen(new SolidBrush(hatchBrush.ForegroundColor));<br /> for (Int32 l = 1; l &lt;= linesCount; l++)<br /> {<br /> g.DrawLine(lPen,<br /> new Point(random.Next(0, this.width), random.Next(0, this.height)),<br /> new Point(random.Next(0, this.width), random.Next(0, this.height))<br /> );<br /> }</p><p> // Clean up.<br /> font.Dispose();<br /> hatchBrush.Dispose();<br /> g.Dispose();</p><p> // Set the image.<br /> this.image = bitmap;<br /> }<br /> }</p><p>[/sourcecode]</p><p>Para sua utilização há, pelo menos, duas metodologias possíveis, uma página que retornará uma imagem, ou uma tag &lt;img&gt; com o base64 da imagem.</p><p>Segue o código da página que retorna a imagem</p><p>[sourcecode language="csharp"]<br /> using System;<br /> using System.Collections;<br /> using System.Configuration;<br /> using System.Data;<br /> using System.Text;<br /> using System.Web;<br /> using System.Web.Security;<br /> using System.Web.UI;<br /> using System.Web.UI.HtmlControls;<br /> using System.Web.UI.WebControls;<br /> using System.Web.UI.WebControls.WebParts;<br /> using System.IO;<br /> using System.Drawing;</p><p>public partial class EventImage : System.Web.UI.Page<br /> {<br /> protected void Page_Load(object sender, EventArgs e)<br /> {<br /> try<br /> {<br /> //Set Response code<br /> this.Response.StatusCode = 200;<br /> this.Response.Status = &quot;200 OK&quot;;</p><p> //Add last modified date<br /> this.Response.AddHeader(&quot;Last-Modified&quot;, DateTime.Now.ToString(&quot;r&quot;, System.Globalization.CultureInfo.CreateSpecificCulture(&quot;en-US&quot;)));</p><p> //Change content type<br /> this.Response.ContentType = &quot;image/png&quot;;</p><p> //Create the captcha bitmap<br /> CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;);</p><p> //Get Byte array of image in PNG<br /> Byte[] imgData = cap.PngImage;</p><p> //Set the byte array of the image in output stream<br /> this.Response.OutputStream.Write(imgData, 0, imgData.Length);</p><p> //Set the session of the text for the captcha validation<br /> Session[&quot;captchaText&quot;] = cap.Text;</p><p> }<br /> catch (Exception ex)<br /> {<br /> //Set error response code<br /> this.Response.Status = &quot;505 Internal error&quot;;<br /> this.Response.StatusCode = 505;<br /> }</p><p> }<br /> }</p><p>[/sourcecode]</p><p>Segue o código para retorno do base64 da imagem</p><p>[sourcecode language="csharp"]<br /> //Create the captcha bitmap<br /> CaptchaImage cap = new CaptchaImage(6, 130, 40, &quot;Verdana&quot;);</p><p>Holder1.Controls.Add(new LiteralControl(&quot;&lt;img border=\&quot;0\&quot; style=\&quot;width: 200px; height: 50px; background: url('data:image/png;base64,&quot; + cap.Base64PngImage + &quot;') no-repeat scroll 0px 0px transparent;\&quot; src=\&quot;/images/empty.gif\&quot; title=\&quot;Imagem de confirmação\&quot;&gt;&quot;));</p><p>//Set the session of the text for the captcha validation<br /> Session[&quot;captchaText&quot;] = cap.Text;<br /> [/sourcecode]</p><p>Note que em ambos as metodologias acima, foi gravado em uma sessão o texto do captcha, desta fora a validação pode ser realizada com esta sessão conforme exemplo abaixo</p><p>[sourcecode language="csharp"]<br /> String captchaText = Request.Form[&quot;captcha&quot;];<br /> String sCaptchaText = (String)Session[&quot;captchaText&quot;];<br /> if (sCaptchaText == null)<br /> sCaptchaText = &quot;&quot;;</p><p>if (captchaText.ToLower() = sCaptchaText.ToLower())<br /> {<br /> //OK<br /> }<br /> [/sourcecode]</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/desenvolvimento/'>Desenvolvimento</a>, <a href='/categories/it/'>IT</a>, <a href='/categories/seguran%C3%A7a-da-informa%C3%A7%C3%A3o/'>Segurança da Informação</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Criando CAPTCHA com C# - Helvio Junior&url=https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Criando CAPTCHA com C# - Helvio Junior&u=https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Criando CAPTCHA com C# - Helvio Junior&url=https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/security/osint/localizando-ips-que-respondem-para-uma-url/">Localizando IPs que respondem para uma URL</a><li><a href="/security/osint/locating-url-ips-bypass-waf/">Locating IPs that respond to a URL</a><li><a href="/security/edr/instalando-elasticsearch-edr/">Instalando Elasticsearch EDR</a><li><a href="/it/instalando-openvpn-com-autenticacao-em-mysql/">Instalando OpenVPN com autenticação em MySQL</a><li><a href="/it/osce-osed-e-ecxd-certificacoes-de-desenvolvimento-de-exploits/">OSCE, OSED e eCXD: Certificações de desenvolvimento de Exploits</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/it/devel/instalando-certificado-digital-no-windows-com-c/"><div class="card-body"> <span class="timeago small" > Mar 9, 2012 <i class="unloaded">2012-03-09T15:08:54-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Instalando certificado digital no windows com C#</h3><div class="text-muted small"><p> Este post objetiva mostrar como realizar a instalação de um certificado digital na base de certificados pessoais do usuário através de um aplicativo C#. Quando executado o aplicativo o certificado...</p></div></div></a></div><div class="card"> <a href="/it/devel/convertendo-relatorio-zennmap-para-excel-com-c/"><div class="card-body"> <span class="timeago small" > Mar 9, 2012 <i class="unloaded">2012-03-09T18:09:32-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Convertendo relatório Zenmap (nmap) para Excel com C#</h3><div class="text-muted small"><p> O objetivo deste aplicativo é converter o arquivo gerado pelo Zenmap (Nmap) para uma planilha do excel. O Aplicativo tem como entrada o arquivo XML do zenmap e gera um arquivo XML com um padrão rec...</p></div></div></a></div><div class="card"> <a href="/it/devel/assinando-digitalmente-aplicativo-java-com-ca-windows/"><div class="card-body"> <span class="timeago small" > Apr 30, 2012 <i class="unloaded">2012-04-30T14:29:53-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Assinando digitalmente aplicativo JAVA com CA Windows</h3><div class="text-muted small"><p> O Objetivo deste post é demonstrar como realizar a assinatura de um aplicativo JAVA utilizando uma Autoridade Certificadora (CA) Windows. Motivação Em um ambiente corporativo com infraestrutura de ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/it/devel/convertendo-relatorio-zennmap-para-excel-com-c/" class="btn btn-outline-primary" prompt="Older"><p>Convertendo relatório Zenmap (nmap) para Excel com C#</p></a> <a href="/it/devel/assinando-digitalmente-aplicativo-java-com-ca-windows/" class="btn btn-outline-primary" prompt="Newer"><p>Assinando digitalmente aplicativo JAVA com CA Windows</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Criando CAPTCHA com C#'; this.page.url = 'https://www.helviojunior.com.br/it/devel/criando-captcha-com-c/'; this.page.identifier = '/it/devel/criando-captcha-com-c/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/helviojunior">Helvio junior (aka M4v3r1ck)</a>. <span data-toggle="tooltip" data-placement="top" title="Some rights reserved.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.helviojunior.com.br{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
