<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Instalando e otimizando o MySQL para alto tráfego de dados" /><meta name="author" content="Helvio Junior (m4v3r1ck)" /><meta property="og:locale" content="en_US" /><meta name="description" content="Na maioria dos ambientes onde é instalado o MySQL não se tem configurações mínimas para um alto desempenho do banco de dados. Neste post não pretendo abordar 100% das técnicas, recursos e tecnologias que poderiam ser utilizadas para otimizar o MySQL, mas sim abordar configurações simples mas muito eficazes para otimização do MySQL. De modo geral as configurações aqui propostas se baseiam na seleção de um bom sistema de arquivos para cada função do banco de dados, bem como otimização da configuração para utilizar todo potencial do hardware. ATENÇÃO!!!! Ao realizar qualquer operação em banco de dados que esteja em produção tenha certeza que você tem backup dos seus dados, pois este procedimento excluirá todas as informações da base de dados. Qualquer perda de dados é por sua conta e risco. Atualização do sistema Antes de qualquer instalação é interessante garantir que nosso sistema está atualizado, faça isso com os comandos abaixo [sourcecode language=&quot;shell&quot;]apt-get update apt-get upgrade [/sourcecode] Remoção de instalações antigas O primeiro passo antes de instalar uma nova instalação do MySQL é necessário desinstalar uma versão atual. Gostaria de frisar mais uma vez que este processo apagará todos os dados atuais do seu banco de dados então, tenha certeza de que você tem um backup integro da sua base dedados, pois não me responsabilizo por eventuais perdas de dado em seu ambiente. [sourcecode language=&quot;shell&quot;]apt-get remove --purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-* rm -rf /etc/mysql /var/lib/mysql/* apt-get autoremove apt-get autoclean [/sourcecode] Preparando o ambiente, partições, diretórios e sistema de arquivos Antes de iniciar a instalação do MySQL propriamente dita vamos criar as partições, formatar e montar em uma estrutura de diretório específica para o banco de dados. Instale as dependências necessárias [sourcecode language=&quot;shell&quot;]apt-get install libaio1 libaio-dev xfsprogs libc6 [/sourcecode] Utilizando o aplicativo de sua preferência, crie 4 partições no disco secundário. As partições devem ser criadas com os tamanhos ajustados para o seu ambiente, para termos um norte segue abaixo uma tabela com a sugestão de tamanho a ser utilizado e a função de cada uma das partições. Obviamente essa é somente uma tabela de sugestão pois diversas coisas irão influenciar na montagem dessa tabela, como quantidade de transações, tamanho da base, o que será armazenado em log e etc... Partição Função Espaço sugerido 1 Armazenamento das bases de dados 85% do disco 2 Armazenamento de logs (Innolog) para rollback, reciperação de desastres e etc... 5% do disco 3 Armazenamento de logs (bin) para replicação e backup incremental 5% do disco 4 Diretório temporário 5% do disco Suponto que o seu disco é de 100Gb e que o mesmo esteja fisicamente no /dev/sdb monte as 4 partições que ficarão da seguinte forma: /dev/sdb1, /dev/sdb2, /dev/sdb3 e /dev/sdb4. Formate o disco com os comandos abaixo, apenas trocando /dev/sdbX para o nome real do seu disco [sourcecode language=&quot;shell&quot;]mkfs.xfs -f -d agcount=256 -l size=128m,lazy-count=1,version=2 -L mysql_bases /dev/sdb1 mkfs.ext2 -m0 -L mysql_innolog /dev/sdb2 mkfs.ext2 -m0 -L mysql_binlog /dev/sdb3 mkfs.ext2 -m0 -L mysql_tmpdir /dev/sdb4 [/sourcecode] Localize o UUID da sua partição [sourcecode language=&quot;shell&quot;]ls -l /dev/disk/by-uuid [/sourcecode] Edite o arquivo /etc/fstab e adicione as linhas abaixo, utilizando o UUID do seu disco, para que o seu disco seja montado na inicialização [sourcecode language=&quot;shell&quot;]UUID=71ce0a1a-cff9-4ade-985c-aaf4bfabd7f9 /u01/mysql/bases/ xfs allocsize=256m,logbufs=8,noatime,nobarrier,nodiratime,attr2,logbsize=256k 0 0 UUID=ad22e209-08b4-405c-9c6b-7ac9da2e4376 /u01/mysql/innolog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=f08fabbd-5ac5-41cb-9c8e-ad9f01492d88 /u01/mysql/binlog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=3b7f233a-cdbb-44a1-9d60-d878af3ea7e4 /u01/mysql/tmpdir/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 [/sourcecode] Crie os diretórios que serão utilizados pelo banco de dados [sourcecode language=&quot;shell&quot;]mkdir -p /u01/mysql/bases/ mkdir -p /u01/mysql/innolog/ mkdir -p /u01/mysql/tmpdir/ mkdir -p /u01/mysql/logs/ mkdir -p /u01/mysql/binlog/relay [/sourcecode] Adicione o usuário e grupo do mysql [sourcecode language=&quot;shell&quot;]groupadd mysql useradd -r -g mysql mysql [/sourcecode] Monte todos os apontamentos realizados no fstab [sourcecode language=&quot;shell&quot;]mount -a [/sourcecode] Crie o arquivo de logs [sourcecode language=&quot;shell&quot;]touch /u01/mysql/logs/error.log [/sourcecode] Altere as permissões dos diretórios montados e arquivos [sourcecode language=&quot;shell&quot;]chown -R mysql:mysql /u01 chmod -R 755 /u01/mysql/ [/sourcecode] Realize algumas otimizações do sistema operacional, bem como a criação de algumas variáveis de ambiente com os comandos abaixo [sourcecode language=&quot;shell&quot;]echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/profile.d/mysql echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/environment echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;# --- MySQL Install --- &quot; &gt;&gt; /etc/sysctl.conf echo &quot;vm.swappiness = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_rmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_wmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_no_metrics_save = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_window_scaling = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_timestamps = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_sack = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.netdev_max_backlog = 5000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_mem = 786432 1048576 26777216&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.ip_local_port_range = 1024 65535&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_max_tw_buckets = 360000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;fs.nr_open = 1048576&quot; &gt;&gt; /etc/sysctl.conf echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf export PATH=$PATH:/usr/local/mysql/bin [/sourcecode] Caso a distribuição do seu Linux seja RedHat ou Centos, é necessário executar o comando abaixo para desativar o SELINUX [sourcecode language=&quot;shell&quot;]sed &#39;s/SELINUX=enforcing/SELINUX=disabled/g &#39; -i /etc/selinux/config reboot [/sourcecode] Instalando o MySQL Realize o download e descompactação do MySQL com os comandos abaixo [sourcecode language=&quot;shell&quot;]wget http://cdn.mysql.com/archives/mysql-5.6/mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz tar -zxvf mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz -C /usr/local ln -sf /usr/local/mysql-5.6.37-linux-glibc2.12-x86_64 /usr/local/mysql [/sourcecode] Copie o script de inicialização do MySQL [sourcecode language=&quot;shell&quot;]cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql [/sourcecode] Edite o arquivo /etc/init.d/mysql alterando as linhas conforme exemplo abaixo [sourcecode language=&quot;shell&quot;]basedir=/usr/local/mysql datadir=/u01/mysql/bases [/sourcecode] Crie o arquivo /u01/mysql/my.cnf com o conteúdo abaixo [sourcecode language=&quot;shell&quot;]## Helvio Junior – my.cnf template ### my.cnf [client] port = 3306 socket = /u01/mysql/mysql.sock [mysqld_safe] open_files_limit = 1024000 basedir = /usr/local/mysql timezone = America/Sao_Paulo socket = /u01/mysql/mysql.sock nice = 0 # Diretório de logs e consultas lentas log-error = /u01/mysql/logs/error.log pid-file = /u01/mysql/bases/mysql.pid [mysqld] open_files_limit = 1024000 general_log = 0 log_warnings = 1 general_log_file = /u01/mysql/logs/mysqld.log log-error = /u01/mysql/logs/error.log log-slow-admin-statements = 0 explicit_defaults_for_timestamp = 1 #Consultas lentas slow_query_log = 1 slow_query_log_file = /u01/mysql/logs/mysql-slow.log long_query_time = 5 #Consultas sem indices log-queries-not-using-indexes = 0 user = mysql pid-file = /u01/mysql/bases/mysql.pid socket = /u01/mysql/mysql.socket port = 3306 basedir = /usr/local/mysql datadir = /u01/mysql/bases/ tmpdir = /u01/mysql/tmpdir lc-messages-dir = /usr/local/mysql/share/ # Performance Analsys performance_schema = off # Desativa o LOAD FILE local-infile = 0 old_passwords=0 # 0x = MASTER # 1x = Slave Level 1 # 2x = Slave em baixo de Slave server-id=01 # Master Setup (Caso tenha replicação) #binlog_format = ROW #log-bin = /u01/mysql/binlog/mysql-bin #log_slave_updates = 1 #log_bin_trust_function_creators = 1 #expire_logs_days = 1 # Configuracoes Diversas #Compatibilidade sql_mode = &#39;&#39; skip-name-resolve max_connections = 10000 query_cache_size = 80M query_cache_min_res_unit = 2K query_cache_type = 1 sort_buffer_size = 2M read_buffer_size = 128k join_buffer_size = 5M myisam_sort_buffer_size = 128M bulk_insert_buffer_size = 128M max_allowed_packet = 1G thread_cache_size = 100 # Tabelas temporárias # Configura o tamanho maximo para tabela do tipo MEMORY max_heap_table_size = 1G # Configura o tamanho maximo antes de converter para MyISAM tmp_table_size = 1G # Federated Store Engine federated # InnoDB (Default) # Depreciado na 5.6 - Armazena dicionario de dados na ram innodb_additional_mem_pool_size = 16M # BUFFER POOL # # Alterar este valor para +- 80 da memória do servidor innodb_buffer_pool_size = 1G # Segregacao do buffer_pool - Performance para algoritmo LRU (qtd cpu) innodb_buffer_pool_instance = 6 # Redo Log innodb_log_buffer_size = 1G innodb_log_group_home_dir = /u01/mysql/innolog innodb_log_files_in_group = 7 innodb_log_file_size = 512M # Manipulacao de arquivos innodb_open_files = 1024000 innodb_file_per_table = 1 innodb_data_file_path = ibdata1:1G:autoextend innodb_data_home_dir=/u01/mysql/bases/ # O_DIRECT para fazer by-pass (O EBS controla) innodb_flush_method = O_DIRECT innodb_file_format = BARRACUDA # QTD de IOPS que esta disponível para o datadir innodb_io_capacity = 1000 # Controle Transacional transaction-isolation=READ-COMMITTED innodb_support_xa = 0 # Qtd de segundos antes de um Lock wait timeout exceeded innodb_lock_wait_timeout = 120 [/sourcecode] Altere o parâmetro innodb_buffer_pool_size deste arquivo recém criado para um valor de +- 80% da memória do ser servidor. Crie um link simbólico do arquivo de configuração para o diretório /etc [sourcecode language=&quot;shell&quot;]ln -s /u01/mysql/my.cnf /etc/my.cnf [/sourcecode] Crie as bases de dados iniciais do MySQL [sourcecode language=&quot;shell&quot;]cd /usr/local/mysql scripts/mysql_install_db --datadir=/u01/mysql/bases/ --basedir=/usr/local/mysql [/sourcecode] Configure para que o MySQL inicie automaticamente na inicialização do sistema operacional e inicie o serviço [sourcecode language=&quot;shell&quot;]update-rc.d -f mysql defaults service mysql start [/sourcecode] Por questões de segurança, altere a senha padrão do usuário root do banco de dados [sourcecode language=&quot;shell&quot;]/usr/local/mysql/bin/mysqladmin -u root password &#39;new-password&#39; [/sourcecode] Pronto, o seu servidor de MySQL está instalado e pronto para uso. Caso deseje outras otimizações não citadas neste post segue uma sugestão se referência para consulta: http://blog.neweb.co/pt/how-to-optimize-a-mysql-server/" /><meta property="og:description" content="Na maioria dos ambientes onde é instalado o MySQL não se tem configurações mínimas para um alto desempenho do banco de dados. Neste post não pretendo abordar 100% das técnicas, recursos e tecnologias que poderiam ser utilizadas para otimizar o MySQL, mas sim abordar configurações simples mas muito eficazes para otimização do MySQL. De modo geral as configurações aqui propostas se baseiam na seleção de um bom sistema de arquivos para cada função do banco de dados, bem como otimização da configuração para utilizar todo potencial do hardware. ATENÇÃO!!!! Ao realizar qualquer operação em banco de dados que esteja em produção tenha certeza que você tem backup dos seus dados, pois este procedimento excluirá todas as informações da base de dados. Qualquer perda de dados é por sua conta e risco. Atualização do sistema Antes de qualquer instalação é interessante garantir que nosso sistema está atualizado, faça isso com os comandos abaixo [sourcecode language=&quot;shell&quot;]apt-get update apt-get upgrade [/sourcecode] Remoção de instalações antigas O primeiro passo antes de instalar uma nova instalação do MySQL é necessário desinstalar uma versão atual. Gostaria de frisar mais uma vez que este processo apagará todos os dados atuais do seu banco de dados então, tenha certeza de que você tem um backup integro da sua base dedados, pois não me responsabilizo por eventuais perdas de dado em seu ambiente. [sourcecode language=&quot;shell&quot;]apt-get remove --purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-* rm -rf /etc/mysql /var/lib/mysql/* apt-get autoremove apt-get autoclean [/sourcecode] Preparando o ambiente, partições, diretórios e sistema de arquivos Antes de iniciar a instalação do MySQL propriamente dita vamos criar as partições, formatar e montar em uma estrutura de diretório específica para o banco de dados. Instale as dependências necessárias [sourcecode language=&quot;shell&quot;]apt-get install libaio1 libaio-dev xfsprogs libc6 [/sourcecode] Utilizando o aplicativo de sua preferência, crie 4 partições no disco secundário. As partições devem ser criadas com os tamanhos ajustados para o seu ambiente, para termos um norte segue abaixo uma tabela com a sugestão de tamanho a ser utilizado e a função de cada uma das partições. Obviamente essa é somente uma tabela de sugestão pois diversas coisas irão influenciar na montagem dessa tabela, como quantidade de transações, tamanho da base, o que será armazenado em log e etc... Partição Função Espaço sugerido 1 Armazenamento das bases de dados 85% do disco 2 Armazenamento de logs (Innolog) para rollback, reciperação de desastres e etc... 5% do disco 3 Armazenamento de logs (bin) para replicação e backup incremental 5% do disco 4 Diretório temporário 5% do disco Suponto que o seu disco é de 100Gb e que o mesmo esteja fisicamente no /dev/sdb monte as 4 partições que ficarão da seguinte forma: /dev/sdb1, /dev/sdb2, /dev/sdb3 e /dev/sdb4. Formate o disco com os comandos abaixo, apenas trocando /dev/sdbX para o nome real do seu disco [sourcecode language=&quot;shell&quot;]mkfs.xfs -f -d agcount=256 -l size=128m,lazy-count=1,version=2 -L mysql_bases /dev/sdb1 mkfs.ext2 -m0 -L mysql_innolog /dev/sdb2 mkfs.ext2 -m0 -L mysql_binlog /dev/sdb3 mkfs.ext2 -m0 -L mysql_tmpdir /dev/sdb4 [/sourcecode] Localize o UUID da sua partição [sourcecode language=&quot;shell&quot;]ls -l /dev/disk/by-uuid [/sourcecode] Edite o arquivo /etc/fstab e adicione as linhas abaixo, utilizando o UUID do seu disco, para que o seu disco seja montado na inicialização [sourcecode language=&quot;shell&quot;]UUID=71ce0a1a-cff9-4ade-985c-aaf4bfabd7f9 /u01/mysql/bases/ xfs allocsize=256m,logbufs=8,noatime,nobarrier,nodiratime,attr2,logbsize=256k 0 0 UUID=ad22e209-08b4-405c-9c6b-7ac9da2e4376 /u01/mysql/innolog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=f08fabbd-5ac5-41cb-9c8e-ad9f01492d88 /u01/mysql/binlog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=3b7f233a-cdbb-44a1-9d60-d878af3ea7e4 /u01/mysql/tmpdir/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 [/sourcecode] Crie os diretórios que serão utilizados pelo banco de dados [sourcecode language=&quot;shell&quot;]mkdir -p /u01/mysql/bases/ mkdir -p /u01/mysql/innolog/ mkdir -p /u01/mysql/tmpdir/ mkdir -p /u01/mysql/logs/ mkdir -p /u01/mysql/binlog/relay [/sourcecode] Adicione o usuário e grupo do mysql [sourcecode language=&quot;shell&quot;]groupadd mysql useradd -r -g mysql mysql [/sourcecode] Monte todos os apontamentos realizados no fstab [sourcecode language=&quot;shell&quot;]mount -a [/sourcecode] Crie o arquivo de logs [sourcecode language=&quot;shell&quot;]touch /u01/mysql/logs/error.log [/sourcecode] Altere as permissões dos diretórios montados e arquivos [sourcecode language=&quot;shell&quot;]chown -R mysql:mysql /u01 chmod -R 755 /u01/mysql/ [/sourcecode] Realize algumas otimizações do sistema operacional, bem como a criação de algumas variáveis de ambiente com os comandos abaixo [sourcecode language=&quot;shell&quot;]echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/profile.d/mysql echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/environment echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;# --- MySQL Install --- &quot; &gt;&gt; /etc/sysctl.conf echo &quot;vm.swappiness = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_rmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_wmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_no_metrics_save = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_window_scaling = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_timestamps = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_sack = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.netdev_max_backlog = 5000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_mem = 786432 1048576 26777216&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.ip_local_port_range = 1024 65535&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_max_tw_buckets = 360000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;fs.nr_open = 1048576&quot; &gt;&gt; /etc/sysctl.conf echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf export PATH=$PATH:/usr/local/mysql/bin [/sourcecode] Caso a distribuição do seu Linux seja RedHat ou Centos, é necessário executar o comando abaixo para desativar o SELINUX [sourcecode language=&quot;shell&quot;]sed &#39;s/SELINUX=enforcing/SELINUX=disabled/g &#39; -i /etc/selinux/config reboot [/sourcecode] Instalando o MySQL Realize o download e descompactação do MySQL com os comandos abaixo [sourcecode language=&quot;shell&quot;]wget http://cdn.mysql.com/archives/mysql-5.6/mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz tar -zxvf mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz -C /usr/local ln -sf /usr/local/mysql-5.6.37-linux-glibc2.12-x86_64 /usr/local/mysql [/sourcecode] Copie o script de inicialização do MySQL [sourcecode language=&quot;shell&quot;]cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql [/sourcecode] Edite o arquivo /etc/init.d/mysql alterando as linhas conforme exemplo abaixo [sourcecode language=&quot;shell&quot;]basedir=/usr/local/mysql datadir=/u01/mysql/bases [/sourcecode] Crie o arquivo /u01/mysql/my.cnf com o conteúdo abaixo [sourcecode language=&quot;shell&quot;]## Helvio Junior – my.cnf template ### my.cnf [client] port = 3306 socket = /u01/mysql/mysql.sock [mysqld_safe] open_files_limit = 1024000 basedir = /usr/local/mysql timezone = America/Sao_Paulo socket = /u01/mysql/mysql.sock nice = 0 # Diretório de logs e consultas lentas log-error = /u01/mysql/logs/error.log pid-file = /u01/mysql/bases/mysql.pid [mysqld] open_files_limit = 1024000 general_log = 0 log_warnings = 1 general_log_file = /u01/mysql/logs/mysqld.log log-error = /u01/mysql/logs/error.log log-slow-admin-statements = 0 explicit_defaults_for_timestamp = 1 #Consultas lentas slow_query_log = 1 slow_query_log_file = /u01/mysql/logs/mysql-slow.log long_query_time = 5 #Consultas sem indices log-queries-not-using-indexes = 0 user = mysql pid-file = /u01/mysql/bases/mysql.pid socket = /u01/mysql/mysql.socket port = 3306 basedir = /usr/local/mysql datadir = /u01/mysql/bases/ tmpdir = /u01/mysql/tmpdir lc-messages-dir = /usr/local/mysql/share/ # Performance Analsys performance_schema = off # Desativa o LOAD FILE local-infile = 0 old_passwords=0 # 0x = MASTER # 1x = Slave Level 1 # 2x = Slave em baixo de Slave server-id=01 # Master Setup (Caso tenha replicação) #binlog_format = ROW #log-bin = /u01/mysql/binlog/mysql-bin #log_slave_updates = 1 #log_bin_trust_function_creators = 1 #expire_logs_days = 1 # Configuracoes Diversas #Compatibilidade sql_mode = &#39;&#39; skip-name-resolve max_connections = 10000 query_cache_size = 80M query_cache_min_res_unit = 2K query_cache_type = 1 sort_buffer_size = 2M read_buffer_size = 128k join_buffer_size = 5M myisam_sort_buffer_size = 128M bulk_insert_buffer_size = 128M max_allowed_packet = 1G thread_cache_size = 100 # Tabelas temporárias # Configura o tamanho maximo para tabela do tipo MEMORY max_heap_table_size = 1G # Configura o tamanho maximo antes de converter para MyISAM tmp_table_size = 1G # Federated Store Engine federated # InnoDB (Default) # Depreciado na 5.6 - Armazena dicionario de dados na ram innodb_additional_mem_pool_size = 16M # BUFFER POOL # # Alterar este valor para +- 80 da memória do servidor innodb_buffer_pool_size = 1G # Segregacao do buffer_pool - Performance para algoritmo LRU (qtd cpu) innodb_buffer_pool_instance = 6 # Redo Log innodb_log_buffer_size = 1G innodb_log_group_home_dir = /u01/mysql/innolog innodb_log_files_in_group = 7 innodb_log_file_size = 512M # Manipulacao de arquivos innodb_open_files = 1024000 innodb_file_per_table = 1 innodb_data_file_path = ibdata1:1G:autoextend innodb_data_home_dir=/u01/mysql/bases/ # O_DIRECT para fazer by-pass (O EBS controla) innodb_flush_method = O_DIRECT innodb_file_format = BARRACUDA # QTD de IOPS que esta disponível para o datadir innodb_io_capacity = 1000 # Controle Transacional transaction-isolation=READ-COMMITTED innodb_support_xa = 0 # Qtd de segundos antes de um Lock wait timeout exceeded innodb_lock_wait_timeout = 120 [/sourcecode] Altere o parâmetro innodb_buffer_pool_size deste arquivo recém criado para um valor de +- 80% da memória do ser servidor. Crie um link simbólico do arquivo de configuração para o diretório /etc [sourcecode language=&quot;shell&quot;]ln -s /u01/mysql/my.cnf /etc/my.cnf [/sourcecode] Crie as bases de dados iniciais do MySQL [sourcecode language=&quot;shell&quot;]cd /usr/local/mysql scripts/mysql_install_db --datadir=/u01/mysql/bases/ --basedir=/usr/local/mysql [/sourcecode] Configure para que o MySQL inicie automaticamente na inicialização do sistema operacional e inicie o serviço [sourcecode language=&quot;shell&quot;]update-rc.d -f mysql defaults service mysql start [/sourcecode] Por questões de segurança, altere a senha padrão do usuário root do banco de dados [sourcecode language=&quot;shell&quot;]/usr/local/mysql/bin/mysqladmin -u root password &#39;new-password&#39; [/sourcecode] Pronto, o seu servidor de MySQL está instalado e pronto para uso. Caso deseje outras otimizações não citadas neste post segue uma sugestão se referência para consulta: http://blog.neweb.co/pt/how-to-optimize-a-mysql-server/" /><link rel="canonical" href="https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" /><meta property="og:url" content="https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" /><meta property="og:site_name" content="Helvio Junior" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2016-05-10T12:40:24-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Instalando e otimizando o MySQL para alto tráfego de dados" /><meta name="twitter:site" content="@helvioju" /><meta name="twitter:creator" content="@Helvio Junior (m4v3r1ck)" /><meta name="google-site-verification" content="JR4IIP9jfvOwxn2ybV_Qn0SrtDPlTrKomdPWgBuP55k"" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Helvio Junior (m4v3r1ck)"},"dateModified":"2023-08-17T00:19:29-03:00","datePublished":"2016-05-10T12:40:24-03:00","description":"Na maioria dos ambientes onde é instalado o MySQL não se tem configurações mínimas para um alto desempenho do banco de dados. Neste post não pretendo abordar 100% das técnicas, recursos e tecnologias que poderiam ser utilizadas para otimizar o MySQL, mas sim abordar configurações simples mas muito eficazes para otimização do MySQL. De modo geral as configurações aqui propostas se baseiam na seleção de um bom sistema de arquivos para cada função do banco de dados, bem como otimização da configuração para utilizar todo potencial do hardware. ATENÇÃO!!!! Ao realizar qualquer operação em banco de dados que esteja em produção tenha certeza que você tem backup dos seus dados, pois este procedimento excluirá todas as informações da base de dados. Qualquer perda de dados é por sua conta e risco. Atualização do sistema Antes de qualquer instalação é interessante garantir que nosso sistema está atualizado, faça isso com os comandos abaixo [sourcecode language=&quot;shell&quot;]apt-get update apt-get upgrade [/sourcecode] Remoção de instalações antigas O primeiro passo antes de instalar uma nova instalação do MySQL é necessário desinstalar uma versão atual. Gostaria de frisar mais uma vez que este processo apagará todos os dados atuais do seu banco de dados então, tenha certeza de que você tem um backup integro da sua base dedados, pois não me responsabilizo por eventuais perdas de dado em seu ambiente. [sourcecode language=&quot;shell&quot;]apt-get remove --purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-* rm -rf /etc/mysql /var/lib/mysql/* apt-get autoremove apt-get autoclean [/sourcecode] Preparando o ambiente, partições, diretórios e sistema de arquivos Antes de iniciar a instalação do MySQL propriamente dita vamos criar as partições, formatar e montar em uma estrutura de diretório específica para o banco de dados. Instale as dependências necessárias [sourcecode language=&quot;shell&quot;]apt-get install libaio1 libaio-dev xfsprogs libc6 [/sourcecode] Utilizando o aplicativo de sua preferência, crie 4 partições no disco secundário. As partições devem ser criadas com os tamanhos ajustados para o seu ambiente, para termos um norte segue abaixo uma tabela com a sugestão de tamanho a ser utilizado e a função de cada uma das partições. Obviamente essa é somente uma tabela de sugestão pois diversas coisas irão influenciar na montagem dessa tabela, como quantidade de transações, tamanho da base, o que será armazenado em log e etc... Partição Função Espaço sugerido 1 Armazenamento das bases de dados 85% do disco 2 Armazenamento de logs (Innolog) para rollback, reciperação de desastres e etc... 5% do disco 3 Armazenamento de logs (bin) para replicação e backup incremental 5% do disco 4 Diretório temporário 5% do disco Suponto que o seu disco é de 100Gb e que o mesmo esteja fisicamente no /dev/sdb monte as 4 partições que ficarão da seguinte forma: /dev/sdb1, /dev/sdb2, /dev/sdb3 e /dev/sdb4. Formate o disco com os comandos abaixo, apenas trocando /dev/sdbX para o nome real do seu disco [sourcecode language=&quot;shell&quot;]mkfs.xfs -f -d agcount=256 -l size=128m,lazy-count=1,version=2 -L mysql_bases /dev/sdb1 mkfs.ext2 -m0 -L mysql_innolog /dev/sdb2 mkfs.ext2 -m0 -L mysql_binlog /dev/sdb3 mkfs.ext2 -m0 -L mysql_tmpdir /dev/sdb4 [/sourcecode] Localize o UUID da sua partição [sourcecode language=&quot;shell&quot;]ls -l /dev/disk/by-uuid [/sourcecode] Edite o arquivo /etc/fstab e adicione as linhas abaixo, utilizando o UUID do seu disco, para que o seu disco seja montado na inicialização [sourcecode language=&quot;shell&quot;]UUID=71ce0a1a-cff9-4ade-985c-aaf4bfabd7f9 /u01/mysql/bases/ xfs allocsize=256m,logbufs=8,noatime,nobarrier,nodiratime,attr2,logbsize=256k 0 0 UUID=ad22e209-08b4-405c-9c6b-7ac9da2e4376 /u01/mysql/innolog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=f08fabbd-5ac5-41cb-9c8e-ad9f01492d88 /u01/mysql/binlog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 UUID=3b7f233a-cdbb-44a1-9d60-d878af3ea7e4 /u01/mysql/tmpdir/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0 [/sourcecode] Crie os diretórios que serão utilizados pelo banco de dados [sourcecode language=&quot;shell&quot;]mkdir -p /u01/mysql/bases/ mkdir -p /u01/mysql/innolog/ mkdir -p /u01/mysql/tmpdir/ mkdir -p /u01/mysql/logs/ mkdir -p /u01/mysql/binlog/relay [/sourcecode] Adicione o usuário e grupo do mysql [sourcecode language=&quot;shell&quot;]groupadd mysql useradd -r -g mysql mysql [/sourcecode] Monte todos os apontamentos realizados no fstab [sourcecode language=&quot;shell&quot;]mount -a [/sourcecode] Crie o arquivo de logs [sourcecode language=&quot;shell&quot;]touch /u01/mysql/logs/error.log [/sourcecode] Altere as permissões dos diretórios montados e arquivos [sourcecode language=&quot;shell&quot;]chown -R mysql:mysql /u01 chmod -R 755 /u01/mysql/ [/sourcecode] Realize algumas otimizações do sistema operacional, bem como a criação de algumas variáveis de ambiente com os comandos abaixo [sourcecode language=&quot;shell&quot;]echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/profile.d/mysql echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/environment echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;# --- MySQL Install --- &quot; &gt;&gt; /etc/sysctl.conf echo &quot;vm.swappiness = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.rmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.wmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_rmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_wmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_no_metrics_save = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_window_scaling = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_timestamps = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_sack = 1&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.core.netdev_max_backlog = 5000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_mem = 786432 1048576 26777216&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.ip_local_port_range = 1024 65535&quot; &gt;&gt; /etc/sysctl.conf echo &quot;net.ipv4.tcp_max_tw_buckets = 360000&quot; &gt;&gt; /etc/sysctl.conf echo &quot;fs.nr_open = 1048576&quot; &gt;&gt; /etc/sysctl.conf echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf export PATH=$PATH:/usr/local/mysql/bin [/sourcecode] Caso a distribuição do seu Linux seja RedHat ou Centos, é necessário executar o comando abaixo para desativar o SELINUX [sourcecode language=&quot;shell&quot;]sed &#39;s/SELINUX=enforcing/SELINUX=disabled/g &#39; -i /etc/selinux/config reboot [/sourcecode] Instalando o MySQL Realize o download e descompactação do MySQL com os comandos abaixo [sourcecode language=&quot;shell&quot;]wget http://cdn.mysql.com/archives/mysql-5.6/mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz tar -zxvf mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz -C /usr/local ln -sf /usr/local/mysql-5.6.37-linux-glibc2.12-x86_64 /usr/local/mysql [/sourcecode] Copie o script de inicialização do MySQL [sourcecode language=&quot;shell&quot;]cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql [/sourcecode] Edite o arquivo /etc/init.d/mysql alterando as linhas conforme exemplo abaixo [sourcecode language=&quot;shell&quot;]basedir=/usr/local/mysql datadir=/u01/mysql/bases [/sourcecode] Crie o arquivo /u01/mysql/my.cnf com o conteúdo abaixo [sourcecode language=&quot;shell&quot;]## Helvio Junior – my.cnf template ### my.cnf [client] port = 3306 socket = /u01/mysql/mysql.sock [mysqld_safe] open_files_limit = 1024000 basedir = /usr/local/mysql timezone = America/Sao_Paulo socket = /u01/mysql/mysql.sock nice = 0 # Diretório de logs e consultas lentas log-error = /u01/mysql/logs/error.log pid-file = /u01/mysql/bases/mysql.pid [mysqld] open_files_limit = 1024000 general_log = 0 log_warnings = 1 general_log_file = /u01/mysql/logs/mysqld.log log-error = /u01/mysql/logs/error.log log-slow-admin-statements = 0 explicit_defaults_for_timestamp = 1 #Consultas lentas slow_query_log = 1 slow_query_log_file = /u01/mysql/logs/mysql-slow.log long_query_time = 5 #Consultas sem indices log-queries-not-using-indexes = 0 user = mysql pid-file = /u01/mysql/bases/mysql.pid socket = /u01/mysql/mysql.socket port = 3306 basedir = /usr/local/mysql datadir = /u01/mysql/bases/ tmpdir = /u01/mysql/tmpdir lc-messages-dir = /usr/local/mysql/share/ # Performance Analsys performance_schema = off # Desativa o LOAD FILE local-infile = 0 old_passwords=0 # 0x = MASTER # 1x = Slave Level 1 # 2x = Slave em baixo de Slave server-id=01 # Master Setup (Caso tenha replicação) #binlog_format = ROW #log-bin = /u01/mysql/binlog/mysql-bin #log_slave_updates = 1 #log_bin_trust_function_creators = 1 #expire_logs_days = 1 # Configuracoes Diversas #Compatibilidade sql_mode = &#39;&#39; skip-name-resolve max_connections = 10000 query_cache_size = 80M query_cache_min_res_unit = 2K query_cache_type = 1 sort_buffer_size = 2M read_buffer_size = 128k join_buffer_size = 5M myisam_sort_buffer_size = 128M bulk_insert_buffer_size = 128M max_allowed_packet = 1G thread_cache_size = 100 # Tabelas temporárias # Configura o tamanho maximo para tabela do tipo MEMORY max_heap_table_size = 1G # Configura o tamanho maximo antes de converter para MyISAM tmp_table_size = 1G # Federated Store Engine federated # InnoDB (Default) # Depreciado na 5.6 - Armazena dicionario de dados na ram innodb_additional_mem_pool_size = 16M # BUFFER POOL # # Alterar este valor para +- 80 da memória do servidor innodb_buffer_pool_size = 1G # Segregacao do buffer_pool - Performance para algoritmo LRU (qtd cpu) innodb_buffer_pool_instance = 6 # Redo Log innodb_log_buffer_size = 1G innodb_log_group_home_dir = /u01/mysql/innolog innodb_log_files_in_group = 7 innodb_log_file_size = 512M # Manipulacao de arquivos innodb_open_files = 1024000 innodb_file_per_table = 1 innodb_data_file_path = ibdata1:1G:autoextend innodb_data_home_dir=/u01/mysql/bases/ # O_DIRECT para fazer by-pass (O EBS controla) innodb_flush_method = O_DIRECT innodb_file_format = BARRACUDA # QTD de IOPS que esta disponível para o datadir innodb_io_capacity = 1000 # Controle Transacional transaction-isolation=READ-COMMITTED innodb_support_xa = 0 # Qtd de segundos antes de um Lock wait timeout exceeded innodb_lock_wait_timeout = 120 [/sourcecode] Altere o parâmetro innodb_buffer_pool_size deste arquivo recém criado para um valor de +- 80% da memória do ser servidor. Crie um link simbólico do arquivo de configuração para o diretório /etc [sourcecode language=&quot;shell&quot;]ln -s /u01/mysql/my.cnf /etc/my.cnf [/sourcecode] Crie as bases de dados iniciais do MySQL [sourcecode language=&quot;shell&quot;]cd /usr/local/mysql scripts/mysql_install_db --datadir=/u01/mysql/bases/ --basedir=/usr/local/mysql [/sourcecode] Configure para que o MySQL inicie automaticamente na inicialização do sistema operacional e inicie o serviço [sourcecode language=&quot;shell&quot;]update-rc.d -f mysql defaults service mysql start [/sourcecode] Por questões de segurança, altere a senha padrão do usuário root do banco de dados [sourcecode language=&quot;shell&quot;]/usr/local/mysql/bin/mysqladmin -u root password &#39;new-password&#39; [/sourcecode] Pronto, o seu servidor de MySQL está instalado e pronto para uso. Caso deseje outras otimizações não citadas neste post segue uma sugestão se referência para consulta: http://blog.neweb.co/pt/how-to-optimize-a-mysql-server/","headline":"Instalando e otimizando o MySQL para alto tráfego de dados","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/"},"url":"https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/"}</script><title>Instalando e otimizando o MySQL para alto tráfego de dados | Helvio Junior</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Helvio Junior"><meta name="application-name" content="Helvio Junior"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/m4v3r1ck.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Helvio Junior</a></div><div class="site-subtitle font-italic">Cyber security researcher, speaker, low level and binary exploitation entusiast. <br /><br />"I’m just a child who has never grown up. I still keep asking these 'how' & 'why' questions. Occasionally, I find an answer. Stephen Hawking"</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://www.linkedin.com/in/helviojunior" aria-label="linkedin" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/@Sec4US" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/helviojunior" aria-label="github" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['helvio.junior','sec4us.com.br'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/it"> It </a> </span> <span> <a href="/mysql"> Mysql </a> </span> <span>Instalando e otimizando o MySQL para alto tráfego de dados</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Instalando e otimizando o MySQL para alto tráfego de dados</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Helvio Junior (m4v3r1ck) </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, May 10, 2016, 12:40 PM -0300" prep="on" > May 10, 2016 <i class="unloaded">2016-05-10T12:40:24-03:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 17, 2023, 12:19 AM -0300" prefix="Updated " > Aug 17, 2023 <i class="unloaded">2023-08-17T00:19:29-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1385 words">7 min</span></div></div><div class="post-content"><p>Na maioria dos ambientes onde é instalado o MySQL não se tem configurações mínimas para um alto desempenho do banco de dados. Neste post não pretendo abordar 100% das técnicas, recursos e tecnologias que poderiam ser utilizadas para otimizar o MySQL, mas sim abordar configurações simples mas muito eficazes para otimização do MySQL.</p><p>De modo geral as configurações aqui propostas se baseiam na seleção de um bom sistema de arquivos para cada função do banco de dados, bem como otimização da configuração para utilizar todo potencial do hardware.</p><p><strong><span style="color: #ff0000;">ATENÇÃO!!!! Ao realizar qualquer operação em banco de dados que esteja em produção tenha certeza que você tem backup dos seus dados, pois este procedimento excluirá todas as informações da base de dados. Qualquer perda de dados é por sua conta e risco.</span></strong></p><h2>Atualização do sistema</h2><p>Antes de qualquer instalação é interessante garantir que nosso sistema está atualizado, faça isso com os comandos abaixo</p><p>[sourcecode language="shell"]apt-get update<br /> apt-get upgrade<br /> [/sourcecode]</p><h2>Remoção de instalações antigas</h2><p>O primeiro passo antes de instalar uma nova instalação do MySQL é necessário desinstalar uma versão atual. Gostaria de frisar mais uma vez que este processo apagará todos os dados atuais do seu banco de dados então, tenha certeza de que você tem um backup integro da sua base dedados, pois não me responsabilizo por eventuais perdas de dado em seu ambiente.</p><p>[sourcecode language="shell"]apt-get remove --purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-*<br /> rm -rf /etc/mysql /var/lib/mysql/*<br /> apt-get autoremove<br /> apt-get autoclean<br /> [/sourcecode]</p><h2>Preparando o ambiente, partições, diretórios e sistema de arquivos</h2><p>Antes de iniciar a instalação do MySQL propriamente dita vamos criar as partições, formatar e montar em uma estrutura de diretório específica para o banco de dados.</p><p>Instale as dependências necessárias</p><p>[sourcecode language="shell"]apt-get install libaio1 libaio-dev xfsprogs libc6<br /> [/sourcecode]</p><p>Utilizando o aplicativo de sua preferência, crie 4 partições no disco secundário. As partições devem ser criadas com os tamanhos ajustados para o seu ambiente, para termos um norte segue abaixo uma tabela com a sugestão de tamanho a ser utilizado e a função de cada uma das partições.</p><p>Obviamente essa é somente uma tabela de sugestão pois diversas coisas irão influenciar na montagem dessa tabela, como quantidade de transações, tamanho da base, o que será armazenado em log e etc...</p><div class="table-wrapper"><table style="height: 202px;" width="665"><tbody><tr><td width="64"><strong>Partição</strong><td width="291"><strong>Função</strong><td width="108"><strong>Espaço sugerido</strong><tr><td width="64">1<td width="291">Armazenamento das bases de dados<td width="108">85% do disco<tr><td width="64">2<td width="291">Armazenamento de logs (Innolog) para rollback, reciperação de desastres e etc...<td width="108">5% do disco<tr><td width="64">3<td width="291">Armazenamento de logs (bin) para replicação e backup incremental<td width="108">5% do disco<tr><td width="64">4<td width="291">Diretório temporário<td width="108">5% do disco</table></div><p>Suponto que o seu disco é de 100Gb e que o mesmo esteja fisicamente no <strong>/dev/sdb</strong> monte as 4 partições que ficarão da seguinte forma: <strong>/dev/sdb1</strong>, <strong>/dev/sdb2</strong>, <strong>/dev/sdb3</strong> e <strong>/dev/sdb4</strong>.</p><p>Formate o disco com os comandos abaixo, apenas trocando <strong>/dev/sdbX</strong> para o nome real do seu disco</p><p>[sourcecode language="shell"]mkfs.xfs -f -d agcount=256 -l size=128m,lazy-count=1,version=2 -L mysql_bases /dev/sdb1<br /> mkfs.ext2 -m0 -L mysql_innolog /dev/sdb2<br /> mkfs.ext2 -m0 -L mysql_binlog /dev/sdb3<br /> mkfs.ext2 -m0 -L mysql_tmpdir /dev/sdb4<br /> [/sourcecode]</p><p>Localize o UUID da sua partição</p><p>[sourcecode language="shell"]ls -l /dev/disk/by-uuid<br /> [/sourcecode]</p><p><a href="/assets/2016/05/uuid-mysql.png" class="img-link shimmer" ><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 720 129'%3E%3C/svg%3E" data-src="/assets/2016/05/uuid-mysql.png" alt="uuid-mysql" width="720" height="129" class="lazyload" data-proofer-ignore></a></p><p>Edite o arquivo <strong>/etc/fstab</strong> e adicione as linhas abaixo, utilizando o UUID do seu disco, para que o seu disco seja montado na inicialização</p><p>[sourcecode language="shell"]UUID=71ce0a1a-cff9-4ade-985c-aaf4bfabd7f9 /u01/mysql/bases/ xfs allocsize=256m,logbufs=8,noatime,nobarrier,nodiratime,attr2,logbsize=256k 0 0<br /> UUID=ad22e209-08b4-405c-9c6b-7ac9da2e4376 /u01/mysql/innolog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0<br /> UUID=f08fabbd-5ac5-41cb-9c8e-ad9f01492d88 /u01/mysql/binlog/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0<br /> UUID=3b7f233a-cdbb-44a1-9d60-d878af3ea7e4 /u01/mysql/tmpdir/ ext2 errors=remount-ro,noatime,nodiratime,rw 0 0<br /> [/sourcecode]</p><p>Crie os diretórios que serão utilizados pelo banco de dados</p><p>[sourcecode language="shell"]mkdir -p /u01/mysql/bases/<br /> mkdir -p /u01/mysql/innolog/<br /> mkdir -p /u01/mysql/tmpdir/<br /> mkdir -p /u01/mysql/logs/<br /> mkdir -p /u01/mysql/binlog/relay<br /> [/sourcecode]</p><p>Adicione o usuário e grupo do mysql</p><p>[sourcecode language="shell"]groupadd mysql<br /> useradd -r -g mysql mysql<br /> [/sourcecode]</p><p>Monte todos os apontamentos realizados no fstab</p><p>[sourcecode language="shell"]mount -a<br /> [/sourcecode]</p><p>Crie o arquivo de logs</p><p>[sourcecode language="shell"]touch /u01/mysql/logs/error.log<br /> [/sourcecode]</p><p>Altere as permissões dos diretórios montados e arquivos</p><p>[sourcecode language="shell"]chown -R mysql:mysql /u01<br /> chmod -R 755 /u01/mysql/<br /> [/sourcecode]</p><p>Realize algumas otimizações do sistema operacional, bem como a criação de algumas variáveis de ambiente com os comandos abaixo</p><p>[sourcecode language="shell"]echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/profile.d/mysql<br /> echo &quot;PATH=$PATH:/usr/local/mysql/bin&quot; &gt;&gt; /etc/environment<br /> echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf<br /> echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf<br /> echo &quot;# --- MySQL Install --- &quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;vm.swappiness = 1&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.core.rmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.core.rmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.core.wmem_default = 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.core.wmem_max = 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_rmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_wmem = 10240 87380 33554432&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_no_metrics_save = 1&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_window_scaling = 1&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_timestamps = 1&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_sack = 1&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.core.netdev_max_backlog = 5000&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_mem = 786432 1048576 26777216&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.ip_local_port_range = 1024 65535&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;net.ipv4.tcp_max_tw_buckets = 360000&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;fs.nr_open = 1048576&quot; &gt;&gt; /etc/sysctl.conf<br /> echo &quot;mysql soft nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf<br /> echo &quot;mysql hard nofile 1048576&quot; &gt;&gt; /etc/security/limits.conf<br /> export PATH=$PATH:/usr/local/mysql/bin<br /> [/sourcecode]</p><p>Caso a distribuição do seu Linux seja RedHat ou Centos, é necessário executar o comando abaixo para desativar o SELINUX</p><p>[sourcecode language="shell"]sed 's/SELINUX=enforcing/SELINUX=disabled/g ' -i /etc/selinux/config<br /> reboot<br /> [/sourcecode]</p><h2>Instalando o MySQL</h2><p>Realize o download e descompactação do MySQL com os comandos abaixo</p><p>[sourcecode language="shell"]wget http://cdn.mysql.com/archives/mysql-5.6/mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz<br /> tar -zxvf mysql-5.6.37-linux-glibc2.12-x86_64.tar.gz -C /usr/local<br /> ln -sf /usr/local/mysql-5.6.37-linux-glibc2.12-x86_64 /usr/local/mysql<br /> [/sourcecode]</p><p>Copie o script de inicialização do MySQL</p><p>[sourcecode language="shell"]cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql<br /> [/sourcecode]</p><p>Edite o arquivo <strong>/etc/init.d/mysql</strong> alterando as linhas conforme exemplo abaixo</p><p>[sourcecode language="shell"]basedir=/usr/local/mysql<br /> datadir=/u01/mysql/bases<br /> [/sourcecode]</p><p>Crie o arquivo <strong>/u01/mysql/my.cnf</strong> com o conteúdo abaixo</p><p>[sourcecode language="shell"]## Helvio Junior – my.cnf template<br /> ### my.cnf</p><p>[client]<br /> port = 3306<br /> socket = /u01/mysql/mysql.sock</p><p>[mysqld_safe]<br /> open_files_limit = 1024000<br /> basedir = /usr/local/mysql<br /> timezone = America/Sao_Paulo<br /> socket = /u01/mysql/mysql.sock<br /> nice = 0</p><p># Diretório de logs e consultas lentas<br /> log-error = /u01/mysql/logs/error.log<br /> pid-file = /u01/mysql/bases/mysql.pid</p><p>[mysqld]<br /> open_files_limit = 1024000<br /> general_log = 0<br /> log_warnings = 1<br /> general_log_file = /u01/mysql/logs/mysqld.log<br /> log-error = /u01/mysql/logs/error.log<br /> log-slow-admin-statements = 0<br /> explicit_defaults_for_timestamp = 1</p><p>#Consultas lentas<br /> slow_query_log = 1<br /> slow_query_log_file = /u01/mysql/logs/mysql-slow.log<br /> long_query_time = 5</p><p>#Consultas sem indices<br /> log-queries-not-using-indexes = 0</p><p>user = mysql<br /> pid-file = /u01/mysql/bases/mysql.pid<br /> socket = /u01/mysql/mysql.socket<br /> port = 3306<br /> basedir = /usr/local/mysql<br /> datadir = /u01/mysql/bases/<br /> tmpdir = /u01/mysql/tmpdir<br /> lc-messages-dir = /usr/local/mysql/share/</p><p># Performance Analsys<br /> performance_schema = off</p><p># Desativa o LOAD FILE<br /> local-infile = 0<br /> old_passwords=0</p><p># 0x = MASTER<br /> # 1x = Slave Level 1<br /> # 2x = Slave em baixo de Slave<br /> server-id=01</p><p># Master Setup (Caso tenha replicação)<br /> #binlog_format = ROW<br /> #log-bin = /u01/mysql/binlog/mysql-bin<br /> #log_slave_updates = 1<br /> #log_bin_trust_function_creators = 1<br /> #expire_logs_days = 1</p><p># Configuracoes Diversas<br /> #Compatibilidade<br /> sql_mode = ''</p><p>skip-name-resolve<br /> max_connections = 10000<br /> query_cache_size = 80M<br /> query_cache_min_res_unit = 2K<br /> query_cache_type = 1<br /> sort_buffer_size = 2M<br /> read_buffer_size = 128k<br /> join_buffer_size = 5M<br /> myisam_sort_buffer_size = 128M<br /> bulk_insert_buffer_size = 128M<br /> max_allowed_packet = 1G<br /> thread_cache_size = 100</p><p># Tabelas temporárias<br /> # Configura o tamanho maximo para tabela do tipo MEMORY<br /> max_heap_table_size = 1G</p><p># Configura o tamanho maximo antes de converter para MyISAM<br /> tmp_table_size = 1G</p><p># Federated Store Engine<br /> federated</p><p># InnoDB (Default)</p><p># Depreciado na 5.6 - Armazena dicionario de dados na ram<br /> innodb_additional_mem_pool_size = 16M</p><p># BUFFER POOL<br /> #</p><p># Alterar este valor para +- 80 da memória do servidor<br /> innodb_buffer_pool_size = 1G</p><p># Segregacao do buffer_pool - Performance para algoritmo LRU (qtd cpu)<br /> innodb_buffer_pool_instance = 6</p><p># Redo Log<br /> innodb_log_buffer_size = 1G<br /> innodb_log_group_home_dir = /u01/mysql/innolog<br /> innodb_log_files_in_group = 7<br /> innodb_log_file_size = 512M</p><p># Manipulacao de arquivos<br /> innodb_open_files = 1024000<br /> innodb_file_per_table = 1<br /> innodb_data_file_path = ibdata1:1G:autoextend<br /> innodb_data_home_dir=/u01/mysql/bases/</p><p># O_DIRECT para fazer by-pass (O EBS controla)<br /> innodb_flush_method = O_DIRECT<br /> innodb_file_format = BARRACUDA</p><p># QTD de IOPS que esta disponível para o datadir<br /> innodb_io_capacity = 1000</p><p># Controle Transacional<br /> transaction-isolation=READ-COMMITTED<br /> innodb_support_xa = 0</p><p># Qtd de segundos antes de um Lock wait timeout exceeded<br /> innodb_lock_wait_timeout = 120<br /> [/sourcecode]</p><p>Altere o parâmetro <strong>innodb_buffer_pool_size</strong> deste arquivo recém criado para um valor de +- 80% da memória do ser servidor.</p><p>Crie um link simbólico do arquivo de configuração para o diretório /etc</p><p>[sourcecode language="shell"]ln -s /u01/mysql/my.cnf /etc/my.cnf<br /> [/sourcecode]</p><p>Crie as bases de dados iniciais do MySQL</p><p>[sourcecode language="shell"]cd /usr/local/mysql<br /> scripts/mysql_install_db --datadir=/u01/mysql/bases/ --basedir=/usr/local/mysql<br /> [/sourcecode]</p><p>Configure para que o MySQL inicie automaticamente na inicialização do sistema operacional e inicie o serviço</p><p>[sourcecode language="shell"]update-rc.d -f mysql defaults<br /> service mysql start<br /> [/sourcecode]</p><p>Por questões de segurança, altere a senha padrão do usuário root do banco de dados</p><p>[sourcecode language="shell"]/usr/local/mysql/bin/mysqladmin -u root password 'new-password'<br /> [/sourcecode]</p><p>Pronto, o seu servidor de MySQL está instalado e pronto para uso.</p><p>Caso deseje outras otimizações não citadas neste post segue uma sugestão se referência para consulta: <a href="http://blog.neweb.co/pt/how-to-optimize-a-mysql-server/" target="_blank">http://blog.neweb.co/pt/how-to-optimize-a-mysql-server/</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/mysql/'>MySQL</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Instalando e otimizando o MySQL para alto tráfego de dados - Helvio Junior&url=https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Instalando e otimizando o MySQL para alto tráfego de dados - Helvio Junior&u=https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Instalando e otimizando o MySQL para alto tráfego de dados - Helvio Junior&url=https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/security/osint/localizando-ips-que-respondem-para-uma-url/">Localizando IPs que respondem para uma URL</a><li><a href="/security/osint/locating-url-ips-bypass-waf/">Locating IPs that respond to a URL</a><li><a href="/security/edr/instalando-elasticsearch-edr/">Instalando Elasticsearch EDR</a><li><a href="/it/instalando-openvpn-com-autenticacao-em-mysql/">Instalando OpenVPN com autenticação em MySQL</a><li><a href="/it/osce-osed-e-ecxd-certificacoes-de-desenvolvimento-de-exploits/">OSCE, OSED e eCXD: Certificações de desenvolvimento de Exploits</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/it/resgatando-tamanho-das-bases-de-dados-mysql/"><div class="card-body"> <span class="timeago small" > Jul 31, 2014 <i class="unloaded">2014-07-31T17:56:52-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Resgatando tamanho das bases de dados MySQL</h3><div class="text-muted small"><p> Segue abaixo o comando para listar todas as bases de dados do MySQL com seu respectivo tamanho e espaço livre. [sourcecode language="shell"]SELECT table_schema &quot;Data Base Name&quot;, sum( data...</p></div></div></a></div><div class="card"> <a href="/it/mysql/criando-usuario-mysql/"><div class="card-body"> <span class="timeago small" > Nov 6, 2014 <i class="unloaded">2014-11-06T12:11:54-02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Criando usuário no MySQL</h3><div class="text-muted small"><p> Criando usuário [sourcecode language="shell"]CREATE USER 'nome_do_usuario'@'localhost' IDENTIFIED BY 'senha_do_usuario'; [/sourcecode] Este exemplo demostra como criar um usuário que terá permissão...</p></div></div></a></div><div class="card"> <a href="/it/mysql/restaurando-mysql-com-informacoes-de-progresso/"><div class="card-body"> <span class="timeago small" > Dec 29, 2017 <i class="unloaded">2017-12-29T13:22:43-02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Restaurando MySQL com informações de progresso</h3><div class="text-muted small"><p> Uma das formas mais comuns de realização de Backup de uma base de Dados MySQL é através do mydqldump, porém quando necessita restaurar uma base de dados você fica sem um status de quanto ja foi pro...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/it/influxdb/instalando-influxdb-0-9-no-ubuntu/" class="btn btn-outline-primary" prompt="Older"><p>Instalando InfluxDB 0.9 no ubuntu</p></a> <a href="/it/convertendo-pkcs12-p12-ou-pfx-em-um-keystore-java-jks/" class="btn btn-outline-primary" prompt="Newer"><p>Convertendo PKCS#12 (.p12 ou .pfx) em um KeyStore Java JKS</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Instalando e otimizando o MySQL para alto tráfego de dados'; this.page.url = 'https://www.helviojunior.com.br/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/'; this.page.identifier = '/it/mysql/instalando-e-otimizando-mysql-para-alto-trafego-de-dados/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/helviojunior">Helvio junior (aka M4v3r1ck)</a>. <span data-toggle="tooltip" data-placement="top" title="Some rights reserved.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/pentest/">Pentest</a> <a class="post-tag" href="/tags/autoridade-certificadora/">autoridade certificadora</a> <a class="post-tag" href="/tags/ca/">ca</a> <a class="post-tag" href="/tags/certificate-authority/">certificate authority</a> <a class="post-tag" href="/tags/openssl/">openssl</a> <a class="post-tag" href="/tags/osce3/">OSCE3</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/osed/">OSED</a> <a class="post-tag" href="/tags/osee/">OSEE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.helviojunior.com.br{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
